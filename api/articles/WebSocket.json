{"title":"WebSocket","uid":"2db4480eaccada3af93deb830f4fe8c2","slug":"WebSocket","date":"2025-11-16T03:28:45.000Z","updated":"2025-11-16T03:44:20.763Z","comments":true,"path":"api/articles/WebSocket.json","keywords":"VUE、Python、JAVA","cover":"/medias/WebSocket.png","content":"<h3 id=\"一、-简介\"><a href=\"#一、-简介\" class=\"headerlink\" title=\"一、 简介\"></a>一、 简介</h3><h4 id=\"1-1-什么是-WebSocket\"><a href=\"#1-1-什么是-WebSocket\" class=\"headerlink\" title=\"1.1 什么是 WebSocket\"></a>1.1 什么是 WebSocket</h4><p>WebSocket是一种 协议，用于在Web应用程序和服务器之间建立实时、<a href=\"https://so.csdn.net/so/search?q=%E5%8F%8C%E5%90%91%E7%9A%84&spm=1001.2101.3001.7020\">双向的</a>通信连接。它通过一个单一的TCP连接提供了持久化连接，这使得Web应用程序可以更加实时地传递数据。WebSocket协议最初由W3C开发，并于2011年成为标准。</p>\n<h4 id=\"1-2-WebSocket的优势和劣势\"><a href=\"#1-2-WebSocket的优势和劣势\" class=\"headerlink\" title=\"1.2 WebSocket的优势和劣势\"></a>1.2 WebSocket的优势和劣势</h4><p><strong>WebSocket的优势包括：</strong></p>\n<ul>\n<li><p>**实时性：**由于WebSocket的持久化连接，它可以实现实时的数据传输，避免了Web应用程序需要不断地发送请求以获取最新数据的情况。</p>\n</li>\n<li><p>**双向通信：**WebSocket协议支持双向通信，这意味着服务器可以主动向客户端发送数据，而不需要客户端发送请求。</p>\n</li>\n<li><p>**减少网络负载：**由于WebSocket的持久化连接，它可以减少HTTP请求的数量，从而减少了网络负载。</p>\n</li>\n</ul>\n<p><strong>WebSocket的劣势包括：</strong></p>\n<ul>\n<li><p>**需要浏览器和服务器都支持：**WebSocket是一种相对新的技术，需要浏览器和服务器都支持。一些旧的浏览器和服务器可能不支持WebSocket。</p>\n</li>\n<li><p>**需要额外的开销：**WebSocket需要在服务器上维护长时间的连接，这需要额外的开销，包括内存和CPU。</p>\n</li>\n<li><p>**安全问题：**由于WebSocket允许服务器主动向客户端发送数据，可能会存在安全问题。服务器必须保证只向合法的客户端发送数据。</p>\n</li>\n</ul>\n<h3 id=\"二、-WebSocket的基本概念\"><a href=\"#二、-WebSocket的基本概念\" class=\"headerlink\" title=\"二、 WebSocket的基本概念\"></a>二、 WebSocket的基本概念</h3><h4 id=\"2-1-WebSocket的协议\"><a href=\"#2-1-WebSocket的协议\" class=\"headerlink\" title=\"2.1 WebSocket的协议\"></a>2.1 WebSocket的协议</h4><p><a href=\"https://so.csdn.net/so/search?q=WebSocket%20%E5%8D%8F%E8%AE%AE&spm=1001.2101.3001.7020\">WebSocket 协议</a>是一种基于TCP的协议，用于在 客户端 和服务器之间建立持久连接，并且可以在这个连接上实时地交换数据。WebSocket协议有自己的握手协议，用于建立连接，也有自己的数据传输格式。</p>\n<p>当客户端发送一个 WebSocket 请求时，服务器 将发送一个协议响应以确认请求。在握手期间，客户端和服务器将协商使用的协议版本、支持的子协议、支持的扩展选项等。一旦握手完成，连接将保持打开状态，客户端和服务器就可以在连接上实时地传递数据。</p>\n<p>WebSocket 协议使用的是双向数据传输，即客户端和服务器都可以在任意时间向对方发送数据，而不需要等待对方的请求。它支持 二进制 数据和文本数据，可以自由地在它们之间进行转换。</p>\n<p>总之，WebSocket协议是一种可靠的、高效的、双向的、持久的通信协议，它适用于需要实时通信的Web应用程序，如在线游戏、实时聊天等。</p>\n<h4 id=\"2-2-WebSocket的生命周期\"><a href=\"#2-2-WebSocket的生命周期\" class=\"headerlink\" title=\"2.2 WebSocket的生命周期\"></a>2.2 WebSocket的生命周期</h4><p>WebSocket 生命周期描述了 WebSocket 连接从创建到关闭的过程。一个 WebSocket 连接包含以下四个主要阶段：</p>\n<ul>\n<li><p>**连接建立阶段（Connection Establishment）：**在这个阶段，客户端和服务器之间的 WebSocket 连接被建立。客户端发送一个 WebSocket 握手请求，服务器响应一个握手响应，然后连接就被建立了。</p>\n</li>\n<li><p>**连接开放阶段（Connection Open）：**在这个阶段，WebSocket 连接已经建立并开放，客户端和服务器可以在连接上互相发送数据。</p>\n</li>\n<li><p>**连接关闭阶段（Connection Closing）：**在这个阶段，一个 WebSocket 连接即将被关闭。它可以被客户端或服务器发起，通过发送一个关闭帧来关闭连接。</p>\n</li>\n<li><p>**连接关闭完成阶段（Connection Closed）：**在这个阶段，WebSocket 连接已经完全关闭。客户端和服务器之间的任何交互都将无效。</p>\n</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>需要注意的是，WebSocket 连接在任何时候都可能关闭，例如网络故障、服务器崩溃等情况都可能导致连接关闭。因此，需要及时处理 WebSocket 连接关闭的事件，以确保应用程序的可靠性和稳定性。</p></blockquote>\n<p>下面是一个简单的 WebSocket 生命周期示意图：</p>\n<p><img src=\"/post/WebSocket/image-20251115212557838.png\" alt=\"image-20251115212557838\"></p>\n<p>在这个示意图中，客户端向服务器发送一个 WebSocket 握手请求，服务器响应一个握手响应，连接就被建立了。一旦连接建立，客户端和服务器就可以在连接上互相发送数据，直到其中一方发送一个关闭帧来关闭连接。在关闭帧被接收后，连接就会被关闭，WebSocket 连接关闭完成。</p>\n<h3 id=\"三、-WebSocket的性能\"><a href=\"#三、-WebSocket的性能\" class=\"headerlink\" title=\"三、 WebSocket的性能\"></a>三、 WebSocket的性能</h3><h4 id=\"3-1-与传统的HTTP请求-响应模型比较\"><a href=\"#3-1-与传统的HTTP请求-响应模型比较\" class=\"headerlink\" title=\"3.1 与传统的HTTP请求&#x2F;响应模型比较\"></a>3.1 与传统的HTTP请求&#x2F;响应模型比较</h4><ul>\n<li><p>**双向通信性能更好：**WebSocket协议使用单一的TCP连接，允许客户端和服务器在同一个连接上进行双向通信。这种实时的双向通信可以更快地传输数据，而不需要建立多个HTTP请求&#x2F;响应连接。</p>\n</li>\n<li><p>**更小的网络流量：**与HTTP相比，WebSocket协议需要更少的网络流量来维护连接，因为它不需要在每个请求&#x2F;响应交换中发送头部信息。</p>\n</li>\n<li><p>**更低的延迟：**WebSocket协议允许服务器主动向客户端推送消息，而不需要客户端先发送请求。这种实时通信可以减少响应延迟，并提高应用程序的性能。</p>\n</li>\n<li><p>**更好的服务器资源管理：**由于WebSocket连接可以保持活动状态，服务器可以更好地管理客户端连接，减少服务器开销和处理时间。</p>\n</li>\n</ul>\n<p>WebSocket协议的性能比传统的HTTP请求&#x2F;响应模型更好，特别是在实时通信和低延迟方面。WebSocket协议适用于需要实时通信和实时数据更新的应用程序，如在线聊天、多人游戏、实时监控等。</p>\n<h4 id=\"3-2-优化WebSocket的性能\"><a href=\"#3-2-优化WebSocket的性能\" class=\"headerlink\" title=\"3.2 优化WebSocket的性能\"></a>3.2 优化WebSocket的性能</h4><ul>\n<li><p>**减少消息大小：**WebSocket 传输的数据大小对性能有很大影响。尽量减少消息的大小，可以降低网络带宽和服务器负载。例如，可以使用二进制传输协议来代替文本传输，或使用压缩算法对消息进行压缩。</p>\n</li>\n<li><p>**使用CDN加速：**使用 CDN（内容分发网络）可以将静态资源缓存到离用户更近的节点上，提高传输速度和性能。CDN 可以缓存 Websocket 的初始握手请求，避免不必要的网络延迟。</p>\n</li>\n<li><p>**使用负载均衡：**WebSocket 服务可以使用负载均衡来分配并平衡多个服务器的负载。负载均衡可以避免单个服务器被过载，并提高整个服务的可伸缩性。</p>\n</li>\n<li><p>**优化服务端代码：**WebSocket 服务端代码的性能也是关键因素。使用高效的框架和算法，避免使用过多的内存和 CPU 资源，可以提高服务端的性能和响应速度。</p>\n</li>\n<li><p>**避免网络阻塞：**WebSocket 的性能也会受到网络阻塞的影响。当有太多的连接同时请求数据时，服务器的性能会下降。使用合适的线程池和异步 IO 操作可以避免网络阻塞，提高 WebSocket 服务的并发性能。</p>\n</li>\n</ul>\n<h3 id=\"四、-WebSocket的扩展应用和未来发展方向\"><a href=\"#四、-WebSocket的扩展应用和未来发展方向\" class=\"headerlink\" title=\"四、 WebSocket的扩展应用和未来发展方向\"></a>四、 WebSocket的扩展应用和未来发展方向</h3><ul>\n<li><p>**更加完善的标准规范：**WebSocket 标准规范还有很多可以优化的地方，未来可能会继续完善 WebSocket 的标准规范，以适应更加复杂的应用场景。</p>\n</li>\n<li><p>**更加安全的通信方式：**由于 WebSocket 的开放性，使得它可能会受到一些安全威胁，未来可能会通过加密、身份验证等方式来增强 WebSocket 的安全性。</p>\n</li>\n<li><p>**更好的兼容性：**WebSocket 协议需要在 HTTP 协议的基础上建立连接，因此可能会遇到兼容性问题，未来可能会通过技术手段来解决这些问题。</p>\n</li>\n<li><p>**更好的性能和可伸缩性：**WebSocket 协议的性能和可伸缩性对于复杂的应用场景非常关键，未来可能会通过技术手段来进一步提高 WebSocket 的性能和可伸缩性。</p>\n</li>\n</ul>\n<h3 id=\"五、WebSocket-最佳实践\"><a href=\"#五、WebSocket-最佳实践\" class=\"headerlink\" title=\"五、WebSocket 最佳实践\"></a>五、WebSocket 最佳实践</h3><h4 id=\"WebSocket-配置方法\"><a href=\"#WebSocket-配置方法\" class=\"headerlink\" title=\"WebSocket 配置方法\"></a>WebSocket 配置方法</h4><h5 id=\"registerStompEndpoints-方法\"><a href=\"#registerStompEndpoints-方法\" class=\"headerlink\" title=\"registerStompEndpoints 方法\"></a><code>registerStompEndpoints</code> 方法</h5><p><strong>作用</strong>：注册 STOMP 端点，供前端连接 WebSocket 服务。</p>\n<p><strong>定义位置</strong>：<code>WebSocketConfig.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">registerStompEndpoints</span><span class=\"params\">(StompEndpointRegistry registry)</span> &#123;</span><br><span class=\"line\">    registry.addEndpoint(<span class=\"string\">&quot;/ws-chat&quot;</span>)</span><br><span class=\"line\">            .setAllowedOriginPatterns(<span class=\"string\">&quot;*&quot;</span>)</span><br><span class=\"line\">            .withSockJS(); <span class=\"comment\">// 兼容不支持WebSocket的浏览器</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>参数说明</strong>：</p>\n<ul>\n<li><code>&quot;/ws-chat&quot;</code>：WebSocket 连接端点路径，前端需要连接此路径</li>\n<li><code>setAllowedOriginPatterns(&quot;*&quot;)</code>：允许跨域访问，解决前后端分离的跨域问题</li>\n<li><code>withSockJS()</code>：启用 SockJS 支持，为不支持 WebSocket 的浏览器提供备选方案</li>\n</ul>\n<p><strong>体现位置</strong>：<br>前端通过 <code>new SockJS(&#39;http://localhost:8080/ws-chat&#39;)</code> 连接到此端点。</p>\n<h5 id=\"configureMessageBroker-方法\"><a href=\"#configureMessageBroker-方法\" class=\"headerlink\" title=\"configureMessageBroker 方法\"></a><code>configureMessageBroker</code> 方法</h5><p><strong>作用</strong>：配置消息代理，定义消息路由规则。</p>\n<p><strong>定义位置</strong>：<code>WebSocketConfig.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">configureMessageBroker</span><span class=\"params\">(MessageBrokerRegistry registry)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 创建并配置TaskScheduler用于心跳检测</span></span><br><span class=\"line\">    <span class=\"type\">ThreadPoolTaskScheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolTaskScheduler</span>();</span><br><span class=\"line\">    scheduler.initialize();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 启用心跳检测，设置写入心跳时间为25秒，读取心跳时间为25秒</span></span><br><span class=\"line\">    registry.enableSimpleBroker(<span class=\"string\">&quot;/topic&quot;</span>)</span><br><span class=\"line\">            .setHeartbeatValue(<span class=\"keyword\">new</span> <span class=\"title class_\">long</span>[]&#123;<span class=\"number\">5000</span>, <span class=\"number\">5000</span>&#125;)</span><br><span class=\"line\">            .setTaskScheduler(scheduler); <span class=\"comment\">// 设置TaskScheduler</span></span><br><span class=\"line\">    registry.setApplicationDestinationPrefixes(<span class=\"string\">&quot;/app&quot;</span>); <span class=\"comment\">// 客户端发送消息前缀</span></span><br><span class=\"line\">    registry.setUserDestinationPrefix(<span class=\"string\">&quot;/user&quot;</span>); <span class=\"comment\">// 用户特定目的地前缀</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>参数说明</strong>：</p>\n<ul>\n<li><code>enableSimpleBroker(&quot;/topic&quot;)</code>：启用简单的消息代理，处理以 “&#x2F;topic” 开头的目标</li>\n<li><code>setHeartbeatValue(new long[]&#123;5000, 5000&#125;)</code>：设置心跳检测，每 5 秒发送一次心跳包</li>\n<li><code>setApplicationDestinationPrefixes(&quot;/app&quot;)</code>：设置应用程序目标前缀，客户端发送的消息需以 “&#x2F;app” 开头</li>\n<li><code>setUserDestinationPrefix(&quot;/user&quot;)</code>：设置用户特定目标前缀</li>\n</ul>\n<p><strong>体现位置</strong>：</p>\n<ol>\n<li>前端发送消息到 <code>/app/chat.send</code>，由 <code>@MessageMapping(&quot;/chat.send&quot;)</code>处理</li>\n<li>后端通过 <code>/topic/public</code> 广播消息，前端订阅此主题</li>\n</ol>\n<h4 id=\"消息处理方法\"><a href=\"#消息处理方法\" class=\"headerlink\" title=\"消息处理方法\"></a>消息处理方法</h4><h5 id=\"send-方法\"><a href=\"#send-方法\" class=\"headerlink\" title=\"send 方法\"></a><code>send</code> 方法</h5><p><strong>作用</strong>：处理用户发送的聊天消息。</p>\n<p><strong>定义位置</strong>：<strong>ChatController.java</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MessageMapping(&quot;/chat.send&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@SendTo(&quot;/topic/public&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Message <span class=\"title function_\">send</span><span class=\"params\">(<span class=\"meta\">@Payload</span> Message msg)</span> &#123;</span><br><span class=\"line\">    msg.setType(MessageType.CHAT.name());</span><br><span class=\"line\">    msg.setCreateTime(LocalDateTime.now());</span><br><span class=\"line\">    messageService.save(msg);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> msg;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>注解说明</strong>：</p>\n<ul>\n<li><figure class=\"highlight plaintext\"><figcaption><span>`/app/chat.send` 的消息</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- ```@SendTo(&quot;/topic/public&quot;)```：将返回值广播到 `/topic/public` 主题</span><br><span class=\"line\">- ```@Payload```：提取消息体并转换为 **Message** 对象</span><br><span class=\"line\"></span><br><span class=\"line\">**处理流程**：</span><br><span class=\"line\"></span><br><span class=\"line\">1. 设置消息类型为 **CHAT**</span><br><span class=\"line\">2. 设置创建时间</span><br><span class=\"line\">3. 保存消息到数据库</span><br><span class=\"line\">4. 返回消息对象并广播给所有订阅者</span><br><span class=\"line\"></span><br><span class=\"line\">**体现位置**：</span><br><span class=\"line\">前端通过 `stompClient.publish(&#123;destination: &#x27;/app/chat.send&#x27;&#125;)` 发送消息触发此方法。</span><br><span class=\"line\"></span><br><span class=\"line\">##### `join` 方法</span><br><span class=\"line\"></span><br><span class=\"line\">**作用**：处理用户加入聊天室的通知。</span><br><span class=\"line\"></span><br><span class=\"line\">**定义位置**：``ChatController.java``</span><br><span class=\"line\"></span><br><span class=\"line\">```java</span><br><span class=\"line\">@MessageMapping(&quot;/chat.join&quot;)</span><br><span class=\"line\">@SendTo(&quot;/topic/public&quot;)</span><br><span class=\"line\">public Message join(@Payload Message msg, SimpMessageHeaderAccessor headerAccessor) &#123;</span><br><span class=\"line\">    String sessionId = headerAccessor.getSessionId();</span><br><span class=\"line\">        String username = msg.getSender();</span><br><span class=\"line\"></span><br><span class=\"line\">        // 将用户名和会话ID存储在WebSocket会话属性中</span><br><span class=\"line\">        headerAccessor.getSessionAttributes().put(&quot;username&quot;, username);</span><br><span class=\"line\"></span><br><span class=\"line\">        // 添加会话到用户会话映射</span><br><span class=\"line\">        userSessions.computeIfAbsent(username, k -&gt; new CopyOnWriteArraySet&lt;&gt;()).add(sessionId);</span><br><span class=\"line\"></span><br><span class=\"line\">        // 只有当这是用户第一个会话时才发送加入消息</span><br><span class=\"line\">        if (userSessions.get(username).size() == 1) &#123;</span><br><span class=\"line\">            // 广播更新后的在线用户列表</span><br><span class=\"line\">            messagingTemplate.convertAndSend(&quot;/topic/users&quot;, userSessions.keySet());</span><br><span class=\"line\"></span><br><span class=\"line\">            msg.setType(MessageType.JOIN.name());</span><br><span class=\"line\">            msg.setContent(username + &quot; 加入了聊天室&quot;);</span><br><span class=\"line\">            msg.setCreateTime(LocalDateTime.now());</span><br><span class=\"line\">            messageService.save(msg);</span><br><span class=\"line\">            return msg;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        // 如果用户已经有其他会话，只更新用户列表但不发送加入消息</span><br><span class=\"line\">        messagingTemplate.convertAndSend(&quot;/topic/users&quot;, userSessions.keySet());</span><br><span class=\"line\">        return null; // 不广播消息</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p><strong>特殊参数</strong>：</p>\n<ul>\n<li><code>SimpMessageHeaderAccessor</code>：用于访问和修改 WebSocket 会话属性</li>\n</ul>\n<p><strong>处理流程</strong>：</p>\n<ol>\n<li>将用户名存入会话属性，便于后续使用</li>\n<li>设置消息类型为<strong>JOIN</strong></li>\n<li>设置欢迎消息内容</li>\n<li>设置创建时间</li>\n<li>保存消息到数据库</li>\n<li>返回消息对象并广播给所有订阅者</li>\n</ol>\n<p><strong>体现位置</strong>：<br>前端连接成功后通过 <code>stompClient.publish(&#123;destination: &#39;/app/chat.join&#39;&#125;)</code> 发送加入消息触发此方法。</p>\n<h5 id=\"leave-方法\"><a href=\"#leave-方法\" class=\"headerlink\" title=\"leave 方法\"></a><code>leave</code> 方法</h5><p><strong>作用</strong>：处理用户离开聊天室的通知。</p>\n<p><strong>定义位置</strong>：<code>ChatController.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MessageMapping(&quot;/chat.leave&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@SendTo(&quot;/topic/public&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Message <span class=\"title function_\">leave</span><span class=\"params\">(<span class=\"meta\">@Payload</span> Message msg)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">String</span> <span class=\"variable\">username</span> <span class=\"operator\">=</span> msg.getSender();</span><br><span class=\"line\">\theaderAccessor.getSessionAttributes().remove(<span class=\"string\">&quot;username&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 只有当用户没有任何会话时才发送离开消息</span></span><br><span class=\"line\">    <span class=\"type\">Message</span> <span class=\"variable\">leaveMessage</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Message</span>();</span><br><span class=\"line\">    leaveMessage.setSender(username);</span><br><span class=\"line\">    leaveMessage.setCreateTime(LocalDateTime.now());</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!userSessions.containsKey(username) || userSessions.get(username).isEmpty()) &#123;</span><br><span class=\"line\">\tleaveMessage.setType(MessageType.LEAVE.name());</span><br><span class=\"line\">    leaveMessage.setContent(username + <span class=\"string\">&quot; 离开了聊天室&quot;</span>);</span><br><span class=\"line\">    messageService.save(leaveMessage);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> leaveMessage;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>; <span class=\"comment\">// 不广播消息</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理流程</strong>：</p>\n<ol>\n<li>设置消息类型为 <strong>LEAVE</strong></li>\n<li>设置告别消息内容</li>\n<li>设置创建时间</li>\n<li>保存消息到数据库</li>\n<li>返回消息对象并广播给所有订阅者</li>\n</ol>\n<p><strong>体现位置</strong>：<br>前端点击”离开”按钮时通过 <code>stompClient.publish(&#123;destination: &#39;/app/chat.leave&#39;&#125;)</code> 发送离开消息触发此方法。</p>\n<h5 id=\"history-方法\"><a href=\"#history-方法\" class=\"headerlink\" title=\"history 方法\"></a><code>history</code> 方法</h5><p><strong>作用</strong>：获取历史聊天记录。</p>\n<p><strong>定义位置</strong>：<code>ChatController.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MessageMapping(&quot;/chat.history&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@SendTo(&quot;/topic/public&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> List&lt;Message&gt; <span class=\"title function_\">history</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 获取最近的50条消息作为历史记录</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> messageService.list().stream().skip(Math.max(<span class=\"number\">0</span>, messageService.count() - <span class=\"number\">50</span>)).toList();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理流程</strong>：</p>\n<ol>\n<li>从数据库查询所有消息</li>\n<li>仅保留最近的 50 条消息</li>\n<li>返回消息列表并广播给请求者</li>\n</ol>\n<p><strong>体现位置</strong>：<br>前端连接成功后通过 <code>stompClient.publish(&#123;destination: &#39;/app/chat.history&#39;&#125;)</code> 请求历史消息触发此方法。</p>\n<h4 id=\"实体类和枚举\"><a href=\"#实体类和枚举\" class=\"headerlink\" title=\"实体类和枚举\"></a>实体类和枚举</h4><h5 id=\"Message-类\"><a href=\"#Message-类\" class=\"headerlink\" title=\"Message 类\"></a>Message 类</h5><p><strong>作用</strong>：表示聊天消息的数据模型。</p>\n<p><strong>定义位置</strong>：<code>Message.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;message&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Message</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@TableId(type = IdType.AUTO)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> String sender; <span class=\"comment\">// 发送者</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> String content; <span class=\"comment\">// 内容</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> String type; <span class=\"comment\">// JOIN / CHAT / LEAVE</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.INSERT)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LocalDateTime createTime; <span class=\"comment\">// 创建时间</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>字段说明</strong>：</p>\n<ul>\n<li><code>id</code>：消息唯一标识符，自动生成</li>\n<li><code>sender</code>：消息发送者用户名</li>\n<li><code>content</code>：消息内容</li>\n<li><code>type</code>：消息类型（<strong>JOIN</strong>&#x2F;<strong>CHAT</strong>&#x2F;<strong>LEAVE</strong>）</li>\n<li><code>createTime</code>：消息创建时间，插入时自动填充</li>\n</ul>\n<p><strong>体现位置</strong>：<br>在所有消息处理方法中使用，用于封装消息数据。</p>\n<h5 id=\"MessageType-枚举\"><a href=\"#MessageType-枚举\" class=\"headerlink\" title=\"MessageType 枚举\"></a>MessageType 枚举</h5><p><strong>作用</strong>：定义消息类型的枚举值。</p>\n<p><strong>定义位置</strong>：<code>MessageType.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">MessageType</span> &#123;</span><br><span class=\"line\">    CHAT,           <span class=\"comment\">// 聊天消息</span></span><br><span class=\"line\">    JOIN,           <span class=\"comment\">// 用户加入</span></span><br><span class=\"line\">    LEAVE           <span class=\"comment\">// 用户离开</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>体现位置</strong>：<br>在消息处理方法中通过 <code>msg.setType(MessageType.CHAT.name())</code> 等方式设置消息类型。</p>\n<h4 id=\"前端方法详解\"><a href=\"#前端方法详解\" class=\"headerlink\" title=\"前端方法详解\"></a>前端方法详解</h4><h5 id=\"连接管理方法\"><a href=\"#连接管理方法\" class=\"headerlink\" title=\"连接管理方法\"></a>连接管理方法</h5><h6 id=\"connect-方法\"><a href=\"#connect-方法\" class=\"headerlink\" title=\"connect 方法\"></a><code>connect</code> 方法</h6><p><strong>作用</strong>：建立与后端 <code>WebSocket</code> 服务的连接。</p>\n<p><strong>定义位置</strong>：<code>App.vue</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">connect</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">  connectionStatus.<span class=\"property\">value</span> = <span class=\"string\">&#x27;正在连接...&#x27;</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">const</span> socket = <span class=\"keyword\">new</span> <span class=\"title class_\">SockJS</span>(<span class=\"string\">&#x27;http://localhost:8080/ws-chat&#x27;</span>)</span><br><span class=\"line\">  stompClient = <span class=\"keyword\">new</span> <span class=\"title class_\">Client</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">webSocketFactory</span>: <span class=\"function\">() =&gt;</span> socket,</span><br><span class=\"line\">    <span class=\"attr\">reconnectDelay</span>: <span class=\"number\">5000</span>,</span><br><span class=\"line\">    <span class=\"attr\">heartbeatIncoming</span>: <span class=\"number\">5000</span>,</span><br><span class=\"line\">    <span class=\"attr\">heartbeatOutgoing</span>: <span class=\"number\">5000</span>,</span><br><span class=\"line\">    <span class=\"attr\">debug</span>: <span class=\"function\">(<span class=\"params\">str</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(str)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">onConnect</span>: <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      connected.<span class=\"property\">value</span> = <span class=\"literal\">true</span></span><br><span class=\"line\">      connecting.<span class=\"property\">value</span> = <span class=\"literal\">false</span></span><br><span class=\"line\">      reconnectAttempts = <span class=\"number\">0</span> <span class=\"comment\">// 重置重连计数</span></span><br><span class=\"line\">      connectionStatus.<span class=\"property\">value</span> = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Connected: &#x27;</span> + username.<span class=\"property\">value</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 订阅公共聊天频道</span></span><br><span class=\"line\">      stompClient.<span class=\"title function_\">subscribe</span>(<span class=\"string\">&#x27;/topic/public&#x27;</span>, <span class=\"function\">(<span class=\"params\">payload</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> message = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(payload.<span class=\"property\">body</span>)</span><br><span class=\"line\">        <span class=\"comment\">// 检查是否是历史消息请求的响应</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(message)) &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 这是历史消息列表，替换当前消息列表</span></span><br><span class=\"line\">          messages.<span class=\"property\">value</span> = message</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 这是单个消息，添加到消息列表</span></span><br><span class=\"line\">          messages.<span class=\"property\">value</span>.<span class=\"title function_\">push</span>(message)</span><br><span class=\"line\">          <span class=\"title function_\">scrollToBottom</span>()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 订阅在线用户列表</span></span><br><span class=\"line\">      stompClient.<span class=\"title function_\">subscribe</span>(<span class=\"string\">&#x27;/topic/users&#x27;</span>, <span class=\"function\">(<span class=\"params\">payload</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> users = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(payload.<span class=\"property\">body</span>)</span><br><span class=\"line\">        onlineUsers.<span class=\"property\">value</span> = users</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 发送加入消息</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> joinMessage = &#123;</span><br><span class=\"line\">        <span class=\"attr\">sender</span>: username.<span class=\"property\">value</span>,</span><br><span class=\"line\">        <span class=\"attr\">content</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;JOIN&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      stompClient.<span class=\"title function_\">publish</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">destination</span>: <span class=\"string\">&#x27;/app/chat.join&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">body</span>: <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(joinMessage)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 请求历史消息</span></span><br><span class=\"line\">      <span class=\"title function_\">requestHistory</span>()</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">onDisconnect</span>: <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      connected.<span class=\"property\">value</span> = <span class=\"literal\">false</span></span><br><span class=\"line\">      connecting.<span class=\"property\">value</span> = <span class=\"literal\">false</span></span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Disconnected&#x27;</span>)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">onStompError</span>: <span class=\"function\">(<span class=\"params\">frame</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(<span class=\"string\">&#x27;Broker reported error: &#x27;</span> + frame.<span class=\"property\">headers</span>[<span class=\"string\">&#x27;message&#x27;</span>])</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(<span class=\"string\">&#x27;Additional details: &#x27;</span> + frame.<span class=\"property\">body</span>)</span><br><span class=\"line\">      connecting.<span class=\"property\">value</span> = <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 处理WebSocket连接错误</span></span><br><span class=\"line\">    <span class=\"attr\">onWebSocketError</span>: <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(<span class=\"string\">&#x27;WebSocket error:&#x27;</span>, event)</span><br><span class=\"line\">      connectionStatus.<span class=\"property\">value</span> = <span class=\"string\">&#x27;连接出错，正在尝试重新连接...&#x27;</span></span><br><span class=\"line\">      connecting.<span class=\"property\">value</span> = <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 处理WebSocket关闭事件</span></span><br><span class=\"line\">    <span class=\"attr\">onWebSocketClose</span>: <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;WebSocket closed:&#x27;</span>, event)</span><br><span class=\"line\">      connected.<span class=\"property\">value</span> = <span class=\"literal\">false</span></span><br><span class=\"line\">      connecting.<span class=\"property\">value</span> = <span class=\"literal\">false</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 如果不是主动断开连接，则尝试重连</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (username.<span class=\"property\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">handleReconnect</span>()</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  stompClient.<span class=\"title function_\">activate</span>()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>配置说明</strong>：</p>\n<ul>\n<li><code>webSocketFactory</code>：使用 <strong>SockJS</strong> 创建 <strong>WebSocket</strong> 连接</li>\n<li><code>reconnectDelay</code>：断线重连延迟 5 秒</li>\n<li><code>heartbeatIncoming/Outgoing</code>：心跳检测每 5 秒一次</li>\n</ul>\n<p><strong>体现位置</strong>：<br>用户输入用户名并点击”加入聊天”按钮时调用此方法。</p>\n<h6 id=\"handleReconnect-方法\"><a href=\"#handleReconnect-方法\" class=\"headerlink\" title=\"handleReconnect 方法\"></a><code>handleReconnect</code> 方法</h6><p><strong>作用</strong>：处理断线重连逻辑。</p>\n<p><strong>定义位置</strong>：<code>App.vue</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">handleReconnect</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (reconnectAttempts &lt; maxReconnectAttempts) &#123;</span><br><span class=\"line\">    reconnectAttempts++</span><br><span class=\"line\">    connectionStatus.<span class=\"property\">value</span> = <span class=\"string\">`连接已断开，第<span class=\"subst\">$&#123;reconnectAttempts&#125;</span>次尝试重连...`</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 使用setTimeout确保在指定延迟后重连</span></span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (username.<span class=\"property\">value</span> &amp;&amp; !connected.<span class=\"property\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">connect</span>()</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;, <span class=\"number\">5000</span>)</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    connectionStatus.<span class=\"property\">value</span> = <span class=\"string\">&#x27;连接失败，请刷新页面重试&#x27;</span></span><br><span class=\"line\">    reconnectAttempts = <span class=\"number\">0</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理流程</strong>：</p>\n<ol>\n<li>检查是否超过最大重连次数</li>\n<li>更新重连尝试计数和状态提示</li>\n<li>延迟 5 秒后尝试重新连接</li>\n<li>超过最大次数则提示用户手动刷新</li>\n</ol>\n<p><strong>体现位置</strong>：<br><strong>WebSocket</strong> 连接意外断开时通过 <code>onWebSocketClose</code> 回调触发。</p>\n<h5 id=\"消息处理方法-1\"><a href=\"#消息处理方法-1\" class=\"headerlink\" title=\"消息处理方法\"></a>消息处理方法</h5><h6 id=\"sendMessage-方法\"><a href=\"#sendMessage-方法\" class=\"headerlink\" title=\"sendMessage 方法\"></a><code>sendMessage</code> 方法</h6><p><strong>作用</strong>：发送聊天消息到后端。</p>\n<p><strong>定义位置</strong>：<code>App.vue</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">sendMessage</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!newMessage.<span class=\"property\">value</span>.<span class=\"title function_\">trim</span>() || !stompClient) <span class=\"keyword\">return</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> chatMessage = &#123;</span><br><span class=\"line\">    <span class=\"attr\">sender</span>: username.<span class=\"property\">value</span>,</span><br><span class=\"line\">    <span class=\"attr\">content</span>: newMessage.<span class=\"property\">value</span>.<span class=\"title function_\">trim</span>(),</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;CHAT&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  stompClient.<span class=\"title function_\">publish</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">destination</span>: <span class=\"string\">&#x27;/app/chat.send&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">body</span>: <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(chatMessage)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">  newMessage.<span class=\"property\">value</span> = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理流程</strong>：</p>\n<ol>\n<li>检查消息内容是否为空</li>\n<li>构造消息对象</li>\n<li>通过 <strong>STOMP</strong> 客户端发布到 <code>/app/chat.send</code></li>\n<li>清空输入框</li>\n</ol>\n<p><strong>体现位置</strong>：<br>用户在输入框按回车或点击”发送”按钮时调用。</p>\n<h6 id=\"requestHistory-方法\"><a href=\"#requestHistory-方法\" class=\"headerlink\" title=\"requestHistory 方法\"></a><code>requestHistory</code> 方法</h6><p><strong>作用</strong>：向前端请求历史聊天记录。</p>\n<p><strong>定义位置</strong>：<code>App.vue</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">requestHistory</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (stompClient &amp;&amp; stompClient.<span class=\"property\">connected</span>) &#123;</span><br><span class=\"line\">    stompClient.<span class=\"title function_\">publish</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">destination</span>: <span class=\"string\">&#x27;/app/chat.history&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">body</span>: <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(&#123;&#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理流程</strong>：</p>\n<ol>\n<li>检查 <strong>STOMP</strong> 客户端是否已连接</li>\n<li>发布空消息到 <code>/app/chat.history</code></li>\n</ol>\n<p><strong>体现位置</strong>：<br><strong>WebSocket</strong> 连接成功后自动调用，获取历史消息。</p>\n<h5 id=\"UI-辅助方法\"><a href=\"#UI-辅助方法\" class=\"headerlink\" title=\"UI 辅助方法\"></a>UI 辅助方法</h5><h6 id=\"getMessageClass-方法\"><a href=\"#getMessageClass-方法\" class=\"headerlink\" title=\"getMessageClass 方法\"></a><code>getMessageClass</code> 方法</h6><p><strong>作用</strong>：根据消息类型返回相应的 CSS 类名。</p>\n<p><strong>定义位置</strong>：<code>App.vue</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getMessageClass</span> = (<span class=\"params\">message</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (message.<span class=\"property\">type</span> === <span class=\"string\">&#x27;JOIN&#x27;</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&#x27;join-message&#x27;</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (message.<span class=\"property\">type</span> === <span class=\"string\">&#x27;LEAVE&#x27;</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&#x27;leave-message&#x27;</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> message.<span class=\"property\">sender</span> === username.<span class=\"property\">value</span> ? <span class=\"string\">&#x27;my-message&#x27;</span> : <span class=\"string\">&#x27;other-message&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理逻辑</strong>：</p>\n<ul>\n<li><strong>JOIN</strong> 类型消息：返回 <code>join-message</code> 样式</li>\n<li><strong>LEAVE</strong> 类型消息：返回 <code>leave-message</code> 样式</li>\n<li><strong>CHAT</strong> 类型消息：根据发送者判断是我方还是对方消息</li>\n</ul>\n<p><strong>体现位置</strong>：<br>在消息列表渲染时通过 <code>:class=&quot;[&#39;message&#39;, getMessageClass(message)]&quot;</code> 应用样式。</p>\n<h6 id=\"formatTime-方法\"><a href=\"#formatTime-方法\" class=\"headerlink\" title=\"formatTime 方法\"></a><code>formatTime</code> 方法</h6><p><strong>作用</strong>：格式化消息时间显示。</p>\n<p><strong>定义位置</strong>：<code>App.vue</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">formatTime</span> = (<span class=\"params\">timeString</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!timeString) <span class=\"keyword\">return</span> <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> date = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(timeString)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> date.<span class=\"title function_\">toLocaleTimeString</span>(<span class=\"string\">&#x27;zh-CN&#x27;</span>, &#123; <span class=\"attr\">hour</span>: <span class=\"string\">&#x27;2-digit&#x27;</span>, <span class=\"attr\">minute</span>: <span class=\"string\">&#x27;2-digit&#x27;</span> &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理流程</strong>：</p>\n<ol>\n<li>检查时间字符串是否存在</li>\n<li>创建 <strong>Date</strong> 对象</li>\n<li>格式化为中文时间格式（<code>HH:mm</code>）</li>\n</ol>\n<p><strong>体现位置</strong>：<br>在每条消息下方通过 <code>&#123;&#123; formatTime(message.createTime) &#125;&#125;</code> 显示时间。</p>\n","feature":true,"text":"一、 简介1.1 什么是 WebSocketWebSocket是一种 协议，用于在Web应用程序和服务器之间建立实时、双向的通信连接。它通过一个单一的TCP连接...","permalink":"/post/WebSocket","photos":[],"count_time":{"symbolsCount":"14k","symbolsTime":"13 mins."},"categories":[{"name":"网络通信","slug":"网络通信","count":3,"path":"api/categories/网络通信.json"}],"tags":[{"name":"网络通信","slug":"网络通信","count":3,"path":"api/tags/网络通信.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81-%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">一、 简介</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-1-%E4%BB%80%E4%B9%88%E6%98%AF-WebSocket\"><span class=\"toc-text\">1.1 什么是 WebSocket</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-2-WebSocket%E7%9A%84%E4%BC%98%E5%8A%BF%E5%92%8C%E5%8A%A3%E5%8A%BF\"><span class=\"toc-text\">1.2 WebSocket的优势和劣势</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81-WebSocket%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\"><span class=\"toc-text\">二、 WebSocket的基本概念</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-1-WebSocket%E7%9A%84%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">2.1 WebSocket的协议</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-2-WebSocket%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F\"><span class=\"toc-text\">2.2 WebSocket的生命周期</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%89%E3%80%81-WebSocket%E7%9A%84%E6%80%A7%E8%83%BD\"><span class=\"toc-text\">三、 WebSocket的性能</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-1-%E4%B8%8E%E4%BC%A0%E7%BB%9F%E7%9A%84HTTP%E8%AF%B7%E6%B1%82-%E5%93%8D%E5%BA%94%E6%A8%A1%E5%9E%8B%E6%AF%94%E8%BE%83\"><span class=\"toc-text\">3.1 与传统的HTTP请求&#x2F;响应模型比较</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-%E4%BC%98%E5%8C%96WebSocket%E7%9A%84%E6%80%A7%E8%83%BD\"><span class=\"toc-text\">3.2 优化WebSocket的性能</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9B%9B%E3%80%81-WebSocket%E7%9A%84%E6%89%A9%E5%B1%95%E5%BA%94%E7%94%A8%E5%92%8C%E6%9C%AA%E6%9D%A5%E5%8F%91%E5%B1%95%E6%96%B9%E5%90%91\"><span class=\"toc-text\">四、 WebSocket的扩展应用和未来发展方向</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BA%94%E3%80%81WebSocket-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5\"><span class=\"toc-text\">五、WebSocket 最佳实践</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#WebSocket-%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">WebSocket 配置方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#registerStompEndpoints-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">registerStompEndpoints 方法</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#configureMessageBroker-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">configureMessageBroker 方法</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%B6%88%E6%81%AF%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">消息处理方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#send-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">send 方法</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#leave-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">leave 方法</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#history-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">history 方法</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%92%8C%E6%9E%9A%E4%B8%BE\"><span class=\"toc-text\">实体类和枚举</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Message-%E7%B1%BB\"><span class=\"toc-text\">Message 类</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#MessageType-%E6%9E%9A%E4%B8%BE\"><span class=\"toc-text\">MessageType 枚举</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%89%8D%E7%AB%AF%E6%96%B9%E6%B3%95%E8%AF%A6%E8%A7%A3\"><span class=\"toc-text\">前端方法详解</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">连接管理方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#connect-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">connect 方法</span></a></li><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#handleReconnect-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">handleReconnect 方法</span></a></li></ol></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%B6%88%E6%81%AF%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95-1\"><span class=\"toc-text\">消息处理方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#sendMessage-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">sendMessage 方法</span></a></li><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#requestHistory-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">requestHistory 方法</span></a></li></ol></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#UI-%E8%BE%85%E5%8A%A9%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">UI 辅助方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#getMessageClass-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">getMessageClass 方法</span></a></li><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#formatTime-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">formatTime 方法</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Azer","slug":"blog-author","avatar":"/images/avatar.png","link":"/","description":"<span style='font-size:30px;background:linear-gradient(90deg,#00c6ff,#0072ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;'>怀民亦未寝</span><span style='font-size:30px;'>💕</span>","socials":{"github":"https://github.com/azer-2025","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_52541129?type=blog","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/1764589563?spm_id_from=333.1007.0.0"},"gitee":{"icon":"/svg/gitee.svg","link":"https://gitee.com/azzzer"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"Netty","uid":"46d3e14db35995d713fed042cf2dff6b","slug":"Netty","date":"2025-11-19T05:37:44.000Z","updated":"2025-11-19T05:39:32.547Z","comments":true,"path":"api/articles/Netty.json","keywords":"VUE、Python、JAVA","cover":"/medias/Netty.png","text":"Netty网络框架详细讲解一、Netty基本内容1.什么是netty？Netty是一个异步的、基于事件驱动的网络应用框架，用于快速开发可维护、高性能的网络服务器...","permalink":"/post/Netty","photos":[],"count_time":{"symbolsCount":"57k","symbolsTime":"52 mins."},"categories":[{"name":"网络通信","slug":"网络通信","count":3,"path":"api/categories/网络通信.json"}],"tags":[{"name":"网络通信","slug":"网络通信","count":3,"path":"api/tags/网络通信.json"}],"author":{"name":"Azer","slug":"blog-author","avatar":"/images/avatar.png","link":"/","description":"<span style='font-size:30px;background:linear-gradient(90deg,#00c6ff,#0072ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;'>怀民亦未寝</span><span style='font-size:30px;'>💕</span>","socials":{"github":"https://github.com/azer-2025","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_52541129?type=blog","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/1764589563?spm_id_from=333.1007.0.0"},"gitee":{"icon":"/svg/gitee.svg","link":"https://gitee.com/azzzer"}}}},"feature":true},"next_post":{"title":"SSE","uid":"6f3bec25b72da0f2f917f80df8077d15","slug":"SSE","date":"2025-11-14T13:54:56.000Z","updated":"2025-11-14T13:57:25.833Z","comments":true,"path":"api/articles/SSE.json","keywords":"VUE、Python、JAVA","cover":"/medias/SSE.png","text":"一、什么是SSE？SSE为何突然爆火？你有没有想过，为什么 ChatGPT 的回答能逐字逐句地“流”出来？ 这一切的背后，都离不开一项关键技术——SSE（Ser...","permalink":"/post/SSE","photos":[],"count_time":{"symbolsCount":"40k","symbolsTime":"36 mins."},"categories":[{"name":"网络通信","slug":"网络通信","count":3,"path":"api/categories/网络通信.json"}],"tags":[{"name":"网络通信","slug":"网络通信","count":3,"path":"api/tags/网络通信.json"}],"author":{"name":"Azer","slug":"blog-author","avatar":"/images/avatar.png","link":"/","description":"<span style='font-size:30px;background:linear-gradient(90deg,#00c6ff,#0072ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;'>怀民亦未寝</span><span style='font-size:30px;'>💕</span>","socials":{"github":"https://github.com/azer-2025","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_52541129?type=blog","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/1764589563?spm_id_from=333.1007.0.0"},"gitee":{"icon":"/svg/gitee.svg","link":"https://gitee.com/azzzer"}}}},"feature":true}}