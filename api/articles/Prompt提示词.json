{"title":"Prompt 工程","uid":"5c0d008f6ea2400e1b86324b9faa98ca","slug":"Prompt提示词","date":"2025-11-05T11:14:09.000Z","updated":"2025-11-05T13:25:18.791Z","comments":true,"path":"api/articles/Prompt提示词.json","keywords":"VUE、Python、JAVA","cover":"/medias/prompt.png","content":"<h1 id=\"1、Prompt-工程\"><a href=\"#1、Prompt-工程\" class=\"headerlink\" title=\"1、Prompt 工程\"></a>1、Prompt 工程</h1><p>​\t\t很多人其实根本不了解<code>Prompt</code> ,这里我自己的最简单的理解是：我自己使用ai的时候，我会先给他一个角色，比如你现在只能用SpringBoot框架语言帮我写，或者是你是一个大文豪诗人，这就是最简单的Prompt，根据你的需求，可以更加细化它自身的设定是个什么东西。</p>\n<h2 id=\"1、基本概念\"><a href=\"#1、基本概念\" class=\"headerlink\" title=\"1、基本概念\"></a>1、基本概念</h2><p>Prompt ⁠工程（Prompt Eng‌ineering）又叫提示词工程，简单来说，就是输入‎给 AI 的指令。比如下面‌这段内容，就是提示词：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">请问Azer的Blog怎么样？</span><br></pre></td></tr></table></figure>\n\n<p>那为什么要叫 “工程” 呢？</p>\n<p>因为 AI 大模型生成⁠的内容是不确定的，构建一个能够按照预期生成‌内容的提示词既是一门艺术，也是一门科学。提示词的质量直接影响到 AI 大模型输出的结‎果，因此这也是 AI 应用开发的关键技能，‌很多公司专门招聘提示词工程师。</p>\n<p>我们学习 ⁠Prompt 工程‌的目标是：通过精心设计和优化输入提示‎来引导 AI 模型‌生成符合预期的高质量输出。</p>\n<h3 id=\"提示词分类\"><a href=\"#提示词分类\" class=\"headerlink\" title=\"提示词分类\"></a>提示词分类</h3><h4 id=\"核心-基于角色的分类\"><a href=\"#核心-基于角色的分类\" class=\"headerlink\" title=\"核心 - 基于角色的分类\"></a>核心 - 基于角色的分类</h4><p>在 AI ⁠对话中，基于角色的‌分类是最常见的，通常存在 3 种主要‎类型的 Promp‌t：</p>\n<p>**1）用户 Promp⁠t (User Prompt)：**这是用户‌向 AI 提供的实际问题、指令或信息，传达了用户的直接需求。用户 Prompt ‎告诉 AI 模型 “做什么”，比如回答问‌题、编写代码、生成创意内容等。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">用户：帮我写一首关于春天的短诗</span><br></pre></td></tr></table></figure>\n\n<p>**2）系统 Prompt⁠ (System Prompt)：**这是设置‌ AI 模型行为规则和角色定位的隐藏指令，用户通常不能直接看到。系统 Prompt ‎相当于给 AI 设定人格和能力边界，即告诉‌ AI “你是谁？你能做什么？”。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">系统：你是一位经验丰富的恋爱顾问，擅长分析情感问题并提供建设性建议。请以温暖友善的语气回答用户的恋爱困惑，必要时主动询问更多信息以便提供更准确的建议。不要做出道德判断，而是尊重用户的情感体验并提供实用的沟通和相处技巧。回答时保持专业性，但避免使用过于学术的术语，确保普通用户能够理解你的建议。</span><br></pre></td></tr></table></figure>\n\n<p>不同的系统 P⁠rompt 可以让同一个 ‌AI 模型表现出完全不同的应用特性，这是构建垂直领域‎ AI 应用（如财务顾问、‌教育辅导、医疗咨询等）的关键。</p>\n<p>比如 23 ⁠年 AI 刚流行的时候‌，很多 AI 助手平台，都是基于设置不同的系‎统 Prompt 来提‌供不同的 AI 助手。</p>\n<p>**3）助手 Prompt ⁠(Assistant Prompt)：**这是 AI‌ 模型的响应内容。在多轮对话中，之前的助手回复也会成为当前上下文的一部分，影响后续对话的理解‎和生成。某些场景下，开发者可以主动预设一些助手消息作‌为对话历史的一部分，引导后续互动。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">助手：我是你的恋爱顾问，很高兴能帮助你解决情感问题。你目前遇到了什么样的恋爱困惑呢？可以告诉我你们的关系现状和具体遇到的问题吗？</span><br></pre></td></tr></table></figure>\n\n<p>在实际应用⁠中，这些不同类型的‌提示词往往会组合使用。举个例子，一个‎完整的对话可能包含‌：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">系统：你是专业编程导师，擅长引导初学者入门编程并制定学习路径。使用友好鼓励的语气，解释复杂概念时要通俗易懂，适当使用比喻让新手理解，避免过于晦涩的技术术语。</span><br><span class=\"line\"></span><br><span class=\"line\">用户：我完全没有编程基础，想学习编程开发，但不知道从何开始，能给我一些建议吗？</span><br><span class=\"line\"></span><br><span class=\"line\">助手：欢迎加入编程的世界！作为编程小白，建议你可以按照以下步骤开始学习之旅...</span><br><span class=\"line\"></span><br><span class=\"line\">【多轮对话继续】</span><br></pre></td></tr></table></figure>\n\n<p>AI 大模⁠型开发平台允许用户‌自主设置各种不同类型的提示词来进行调‎试：</p>\n<p><img src=\"/post/Prompt%E6%8F%90%E7%A4%BA%E8%AF%8D/image-20251105093830794.png\" alt=\"image-20251105093830794\"></p>\n<h2 id=\"2、Token\"><a href=\"#2、Token\" class=\"headerlink\" title=\"2、Token\"></a>2、Token</h2><p>Token 是⁠大模型处理文本的基本单位，可‌能是单词或标点符号，模型的输入和输出都是按 Token ‎计算的，一般 Token 越‌多，成本越高，并且输出速度越慢。</p>\n<p>因此在 A⁠I 应用开发中，了‌解和控制 Token 的消耗至关重要‎。</p>\n<h4 id=\"如何计算-Token？\"><a href=\"#如何计算-Token？\" class=\"headerlink\" title=\"如何计算 Token？\"></a>如何计算 Token？</h4><p>首先，不同⁠大模型对 Toke‌n 的划分规则略有不同，比如根据 O‎penAI 的文档‌：</p>\n<ul>\n<li>英文文本：一个 token 大约相当于 4 个字符或约 0.75 个英文单词</li>\n<li>中文文本：一个汉字通常会被编码为 1-2 个 token</li>\n<li>空格和标点：也会计入 token 数量</li>\n<li>特殊符号和表情符号：可能需要多个 token 来表示</li>\n</ul>\n<p>简单估算一下⁠，100 个英文单词约等‌于 75-150 个 Token，而 100 个‎中文字符约等于 100-‌200 个 Token。</p>\n<p>实际应用中⁠，更推荐使用工具来‌估计 Prompt 的 Token ‎数量，比如：</p>\n<ul>\n<li><a href=\"https://platform.openai.com/tokenizer\">OpenAI Tokenizer</a>：适用于 OpenAI 模型的官方 Token 计算器</li>\n<li><a href=\"https://tiktoken.aigc2d.com/\">非官方的 Token 计算器</a></li>\n</ul>\n<h4 id=\"Token-成本计算\"><a href=\"#Token-成本计算\" class=\"headerlink\" title=\"Token 成本计算\"></a>Token 成本计算</h4><p>估算成本有⁠个公式：总成本 &#x3D;‌ (输入 token数 × 输入单价)‎ + (输出 tok‌en 数 × 输出单价)</p>\n<p>不同大模型⁠的计费都不太一样，‌因此要认真阅读官方文档的计费标准，比‎如阿里系大模型：</p>\n<p><img src=\"/post/Prompt%E6%8F%90%E7%A4%BA%E8%AF%8D/image-20251105094029574.png\" alt=\"image-20251105094029574\"></p>\n<p>建议大家估⁠算成本时，可以多去‌对比不同大模型的价格，参考下列表格去‎整理一个详细的对比‌表格，结果一目了然：</p>\n<table>\n<thead>\n<tr>\n<th>模型</th>\n<th>输入价格 (&#x2F;1K tokens)</th>\n<th>输出价格 (&#x2F;1K tokens)</th>\n<th>1000 字对话预估成本</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>GPT-xx</td>\n<td>$0.0015</td>\n<td>$0.002</td>\n<td>¥0.02-0.03</td>\n</tr>\n<tr>\n<td>GPT-xxx ⁠</td>\n<td>$0.03</td>\n<td>$0.06‌</td>\n<td>¥0.3-0.5</td>\n</tr>\n<tr>\n<td>Claude-xxx</td>\n<td>$0.00‎025</td>\n<td>$0.00125 ‌</td>\n<td>¥0.01-0.02</td>\n</tr>\n</tbody></table>\n<h4 id=\"Token-成本优化技巧\"><a href=\"#Token-成本优化技巧\" class=\"headerlink\" title=\"Token 成本优化技巧\"></a>Token 成本优化技巧</h4><p>注意，系统⁠提示词、用户提示词‌和 AI 大模型输出的内容都是消耗成‎本的，因此我们成本‌优化主要从这些角度进行。</p>\n<p>1）精简系统⁠提示词：移除冗余表述，保‌留核心指令。比如将 “你是一个非常专业、经验丰富‎且非常有耐心的编程导师”‌ 简化为 “你是编程导师”。</p>\n<p>2）定期清理⁠对话历史：对话上下文会随‌着交互不断累积 Token。在长对话中，可以定期‎请求 AI 总结之前的对‌话，然后以总结替代详细历史。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">请总结我们至今的对话要点，后续我们将基于此总结继续讨论。</span><br></pre></td></tr></table></figure>\n\n<p>3）使用向量检索⁠代替直接输入：对于需要处理大量参‌考文档的场景，不要直接将整个文档作为 Prompt，而是使用向量‎数据库和检索技术（RAG）获取‌相关段落。后续教程会带大家实战。</p>\n<p>4）结构化⁠替代自然语言：使用‌表格、列表等结构化格式代替长段落描述‎。</p>\n<p>举个例子，优化前：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">请问如何制作披萨？首先需要准备面粉、酵母、水、盐、橄榄油作为基础面团材料。然后根据口味选择酱料，可以是番茄酱或白酱。接着准备奶酪，最常用的是马苏里拉奶酪。最后准备各种配料如意大利香肠、蘑菇、青椒等。</span><br></pre></td></tr></table></figure>\n\n<p>优化后：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">披萨制作材料：</span><br><span class=\"line\">- 面团：面粉、酵母、水、盐、橄榄油</span><br><span class=\"line\">- 酱料：番茄酱/白酱</span><br><span class=\"line\">- 奶酪：马苏里拉</span><br><span class=\"line\">- 配料：意大利香肠、蘑菇、青椒等</span><br><span class=\"line\"></span><br><span class=\"line\">如何制作？</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、Prompt-优化技巧\"><a href=\"#2、Prompt-优化技巧\" class=\"headerlink\" title=\"2、Prompt 优化技巧\"></a>2、Prompt 优化技巧</h2><p>前面也提到了，⁠设计 Prompt 是一门‌艺术，高质量的 Prompt 可以显著提升 AI 输‎出的质量，因此我们需要重点‌掌握 Prompt 优化技巧。</p>\n<h3 id=\"利用资源\"><a href=\"#利用资源\" class=\"headerlink\" title=\"利用资源\"></a>利用资源</h3><h4 id=\"1、Prompt-学习\"><a href=\"#1、Prompt-学习\" class=\"headerlink\" title=\"1、Prompt 学习\"></a>1、Prompt 学习</h4><p>网上和 Pro⁠mpt 优化相关的资源非常‌丰富，几乎各大主流 AI 大模型和 AI 开发框架官‎方文档都有相关的介绍，推荐‌先阅读至少 2 篇，比如：</p>\n<ul>\n<li><a href=\"https://www.promptingguide.ai/zh\">Prompt Engineering Guide 提示工程指南</a></li>\n<li><a href=\"https://platform.openai.com/docs/guides/prompt-engineering\">OpenAI 提示词工程指南</a></li>\n<li><a href=\"https://docs.spring.io/spring-ai/reference/api/prompt.html#_prompt_engineering\">Spring AI 提示工程指南</a></li>\n<li><a href=\"https://docs.anthropic.com/zh-CN/docs/build-with-claude/prompt-engineering/overview\">Authropic 提示词工程指南</a></li>\n<li><a href=\"https://github.com/anthropics/prompt-eng-interactive-tutorial\">Authropic 提示词工程指南（开源仓库）</a></li>\n<li><a href=\"https://open.bigmodel.cn/dev/guidelines/LanguageModels\">智谱 AI Prompt 设计指南</a></li>\n</ul>\n<h4 id=\"2、Prompt-提示词库\"><a href=\"#2、Prompt-提示词库\" class=\"headerlink\" title=\"2、Prompt 提示词库\"></a>2、Prompt 提示词库</h4><p>网上也有很⁠多现成的提示词库，‌在自主优化提示词前，可以先尝试搜索有‎没有现成的提示词参‌考：</p>\n<ul>\n<li>文本对话：<a href=\"https://docs.anthropic.com/zh-CN/prompt-library/library\">Authropic 提示词库</a></li>\n<li>AI 绘画：<a href=\"https://promptlibrary.org/\">Midjourney 提示词库</a></li>\n</ul>\n<h3 id=\"基础提示技巧\"><a href=\"#基础提示技巧\" class=\"headerlink\" title=\"基础提示技巧\"></a>基础提示技巧</h3><h4 id=\"1、明确指定任务和角色\"><a href=\"#1、明确指定任务和角色\" class=\"headerlink\" title=\"1、明确指定任务和角色\"></a>1、明确指定任务和角色</h4><p>为 AI ⁠提供清晰的任务描述‌和角色定位，帮助模型理解背景和期望。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">系统：你是一位经验丰富的Python教师，擅长向初学者解释编程概念。</span><br><span class=\"line\">用户：请解释 Python 中的列表推导式，包括基本语法和 2-3 个实用示例。</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2、提供详细说明和具体示例\"><a href=\"#2、提供详细说明和具体示例\" class=\"headerlink\" title=\"2、提供详细说明和具体示例\"></a>2、提供详细说明和具体示例</h4><p>提供足够的⁠上下文信息和期望的‌输出格式示例，减少模型的不确定性。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">请提供一个社交媒体营销计划，针对一款新上市的智能手表。计划应包含:</span><br><span class=\"line\">1. 目标受众描述</span><br><span class=\"line\">2. 三个内容主题</span><br><span class=\"line\">3. 每个平台的内容类型建议</span><br><span class=\"line\">4. 发布频率建议</span><br><span class=\"line\"></span><br><span class=\"line\">示例格式:</span><br><span class=\"line\">目标受众: [描述]</span><br><span class=\"line\">内容主题: [主题1], [主题2], [主题3]</span><br><span class=\"line\">平台策略: [平台] - [内容类型] - [频率]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、使用结构化格式引导思维\"><a href=\"#3、使用结构化格式引导思维\" class=\"headerlink\" title=\"3、使用结构化格式引导思维\"></a>3、使用结构化格式引导思维</h4><p>通过列表、表格等结构化格式，使指令更易理解，输出更有条理。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">分析以下公司的优势和劣势:</span><br><span class=\"line\">公司: Tesla</span><br><span class=\"line\"></span><br><span class=\"line\">请使用表格格式回答，包含以下列:</span><br><span class=\"line\">- 优势(最少3项)</span><br><span class=\"line\">- 每项优势的简要分析</span><br><span class=\"line\">- 劣势(最少3项)</span><br><span class=\"line\">- 每项劣势的简要分析</span><br><span class=\"line\">- 应对建议</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4、明确输出格式要求\"><a href=\"#4、明确输出格式要求\" class=\"headerlink\" title=\"4、明确输出格式要求\"></a>4、明确输出格式要求</h4><p>指定输出的格式、长度、风格等要求，获得更符合预期的结果。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">撰写一篇关于气候变化的科普文章，要求:</span><br><span class=\"line\">- 使用通俗易懂的语言，适合高中生阅读</span><br><span class=\"line\">- 包含5个小标题，每个标题下2-3段文字</span><br><span class=\"line\">- 总字数控制在800字左右</span><br><span class=\"line\">- 结尾提供3个可行的个人行动建议</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"进阶提示技巧\"><a href=\"#进阶提示技巧\" class=\"headerlink\" title=\"进阶提示技巧\"></a>进阶提示技巧</h3><h4 id=\"⁠1、思维链提示法（‌Chain-of-Thought）\"><a href=\"#⁠1、思维链提示法（‌Chain-of-Thought）\" class=\"headerlink\" title=\"⁠1、思维链提示法（‌Chain-of-Thought）\"></a>⁠1、思维链提示法（‌Chain-of-Thought）</h4><p>引导模型展示推理过程，逐步思考问题，提高复杂问题的准确性。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">问题：一个商店售卖T恤，每件15元。如果购买5件以上可以享受8折优惠。小明买了7件T恤，他需要支付多少钱？</span><br><span class=\"line\"></span><br><span class=\"line\">请一步步思考解决这个问题:</span><br><span class=\"line\">1. 首先计算7件T恤的原价</span><br><span class=\"line\">2. 确定是否符合折扣条件</span><br><span class=\"line\">3. 如果符合，计算折扣后的价格</span><br><span class=\"line\">4. 得出最终支付金额</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"⁠2、少样本学习（F‌ew-Shot-Learning）\"><a href=\"#⁠2、少样本学习（F‌ew-Shot-Learning）\" class=\"headerlink\" title=\"⁠2、少样本学习（F‌ew-Shot Learning）\"></a>⁠2、少样本学习（F‌ew-Shot Learning）</h4><p>通过提供几⁠个输入 - 输出对的示‌例，帮助模型理解任务模式和期望输出。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">我将给你一些情感分析的例子，然后请你按照同样的方式分析新句子的情感倾向。</span><br><span class=\"line\"></span><br><span class=\"line\">输入: &quot;这家餐厅的服务太差了，等了一个小时才上菜&quot;</span><br><span class=\"line\">输出: 负面，因为描述了长时间等待和差评服务</span><br><span class=\"line\"></span><br><span class=\"line\">输入: &quot;新买的手机屏幕清晰，电池也很耐用&quot;</span><br><span class=\"line\">输出: 正面，因为赞扬了产品的多个方面</span><br><span class=\"line\"></span><br><span class=\"line\">现在分析这个句子:</span><br><span class=\"line\">&quot;这本书内容还行，但是价格有点贵&quot;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、分步骤指导（Step-by-Step）\"><a href=\"#3、分步骤指导（Step-by-Step）\" class=\"headerlink\" title=\"3、分步骤指导（Step-by-Step）\"></a>3、分步骤指导（Step-by-Step）</h4><p>将复杂任务分解为可管理的步骤，确保模型完成每个关键环节。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">请帮我创建一个简单的网站落地页设计方案，按照以下步骤:</span><br><span class=\"line\"></span><br><span class=\"line\">步骤1: 分析目标受众(考虑年龄、职业、需求等因素)</span><br><span class=\"line\">步骤2: 确定页面核心信息(主标题、副标题、价值主张)</span><br><span class=\"line\">步骤3: 设计页面结构(至少包含哪些区块)</span><br><span class=\"line\">步骤4: 制定视觉引导策略(颜色、图像建议)</span><br><span class=\"line\">步骤5: 设计行动召唤(CTA)按钮和文案</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4、自我评估和修正\"><a href=\"#4、自我评估和修正\" class=\"headerlink\" title=\"4、自我评估和修正\"></a>4、自我评估和修正</h4><p>让模型评估自己的输出并进行改进，提高准确性和质量。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">解决以下概率问题:</span><br><span class=\"line\">从一副标准扑克牌中随机抽取两张牌，求抽到至少一张红桃的概率。</span><br><span class=\"line\"></span><br><span class=\"line\">首先给出你的解答，然后:</span><br><span class=\"line\">1. 检查你的推理过程是否存在逻辑错误</span><br><span class=\"line\">2. 验证你使用的概率公式是否正确</span><br><span class=\"line\">3. 检查计算步骤是否有误</span><br><span class=\"line\">4. 如果发现任何问题，提供修正后的解答</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"5、知识检索和引用\"><a href=\"#5、知识检索和引用\" class=\"headerlink\" title=\"5、知识检索和引用\"></a>5、知识检索和引用</h4><p>引导模型检索相关信息并明确引用信息来源，提高可靠性。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">请解释光合作用的过程及其在植物生长中的作用。在回答中:</span><br><span class=\"line\">1. 提供光合作用的科学定义</span><br><span class=\"line\">2. 解释主要的化学反应</span><br><span class=\"line\">3. 描述影响光合作用效率的关键因素</span><br><span class=\"line\">4. 说明其对生态系统的重要性</span><br><span class=\"line\"></span><br><span class=\"line\">对于任何可能需要具体数据或研究支持的陈述，请明确指出这些信息的来源，并说明这些信息的可靠性。</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"6、多视角分析\"><a href=\"#6、多视角分析\" class=\"headerlink\" title=\"6、多视角分析\"></a>6、多视角分析</h4><p>引导模型从不同角度、立场或专业视角分析问题，提供全面见解。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">分析&quot;城市应该禁止私家车进入市中心&quot;这一提议:</span><br><span class=\"line\"></span><br><span class=\"line\">请从以下4个不同角度分析:</span><br><span class=\"line\">1. 环保专家视角</span><br><span class=\"line\">2. 经济学家视角</span><br><span class=\"line\">3. 市中心商户视角</span><br><span class=\"line\">4. 通勤居民视角</span><br><span class=\"line\"></span><br><span class=\"line\">对每个视角:</span><br><span class=\"line\">- 提供支持该提议的2个论点</span><br><span class=\"line\">- 提供反对该提议的2个论点</span><br><span class=\"line\">- 分析可能的折中方案</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"7、多模态思维\"><a href=\"#7、多模态思维\" class=\"headerlink\" title=\"7、多模态思维\"></a>7、多模态思维</h4><p>结合不同表⁠达形式进行思考，如‌文字描述、图表结构、代码逻辑等。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">设计一个智能家居系统的基础架构:</span><br><span class=\"line\"></span><br><span class=\"line\">1. 首先用文字描述系统的主要功能和组件</span><br><span class=\"line\">2. 然后创建一个系统架构图(用ASCII或文本形式表示)</span><br><span class=\"line\">3. 接着提供用户交互流程</span><br><span class=\"line\">4. 最后简述实现这个系统可能面临的技术挑战</span><br><span class=\"line\"></span><br><span class=\"line\">尝试从不同角度思考:功能性、用户体验、技术实现、安全性等。</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"提示词调试与优化\"><a href=\"#提示词调试与优化\" class=\"headerlink\" title=\"提示词调试与优化\"></a>提示词调试与优化</h3><p>好的提示词⁠可能很难一步到位，‌因此我们要学会如何持续调试和优化 Pro‎mpt。</p>\n<h4 id=\"1、迭代式提示优化\"><a href=\"#1、迭代式提示优化\" class=\"headerlink\" title=\"1、迭代式提示优化\"></a>1、迭代式提示优化</h4><p>通过逐步修改和完善提示词，提高输出质量。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">初始提示: 谈谈人工智能的影响。</span><br><span class=\"line\"></span><br><span class=\"line\">[收到笼统回答后]</span><br><span class=\"line\">改进提示: 分析人工智能对医疗行业的三大积极影响和两大潜在风险，提供具体应用案例。</span><br><span class=\"line\"></span><br><span class=\"line\">[如果回答仍然不够具体]</span><br><span class=\"line\">进一步改进: 详细分析AI在医学影像诊断领域的具体应用，包括:</span><br><span class=\"line\">1. 现有的2-3个成功商业化AI诊断系统及其准确率</span><br><span class=\"line\">2. 这些系统如何辅助放射科医生工作</span><br><span class=\"line\">3. 实施过程中遇到的主要挑战</span><br><span class=\"line\">4. 未来3-5年可能的技术发展方向</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2、边界测试\"><a href=\"#2、边界测试\" class=\"headerlink\" title=\"2、边界测试\"></a>2、边界测试</h4><p>通过极限情况测试模型的能力边界，找出优化空间。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">尝试解决以下具有挑战性的数学问题:</span><br><span class=\"line\">证明在三角形中，三条高的交点、三条中线的交点和三条角平分线的交点在同一条直线上。</span><br><span class=\"line\"></span><br><span class=\"line\">如果你发现难以直接证明:</span><br><span class=\"line\">1. 说明你遇到的具体困难</span><br><span class=\"line\">2. 考虑是否有更简单的方法或特例可以探讨</span><br><span class=\"line\">3. 提供一个思路框架，即使无法给出完整证明</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、提示词模板化\"><a href=\"#3、提示词模板化\" class=\"headerlink\" title=\"3、提示词模板化\"></a>3、提示词模板化</h4><p>创建结构化⁠模板，便于针对类似‌任务进行一致性提示，否则每次输出的内‎容可能会有比较大的‌区别，不利于调试。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">【专家角色】: &#123;领域&#125;专家</span><br><span class=\"line\">【任务描述】: &#123;任务详细说明&#125;</span><br><span class=\"line\">【所需内容】:</span><br><span class=\"line\">- &#123;要点1&#125;</span><br><span class=\"line\">- &#123;要点2&#125;</span><br><span class=\"line\">- &#123;要点3&#125;</span><br><span class=\"line\">【输出格式】: &#123;格式要求&#125;</span><br><span class=\"line\">【语言风格】: &#123;风格要求&#125;</span><br><span class=\"line\">【限制条件】: &#123;字数、时间或其他限制&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">例如:</span><br><span class=\"line\">【专家角色】: 营养学专家</span><br><span class=\"line\">【任务描述】: 为一位想减重的上班族设计一周健康饮食计划</span><br><span class=\"line\">【所需内容】:</span><br><span class=\"line\">- 七天的三餐安排</span><br><span class=\"line\">- 每餐的大致卡路里</span><br><span class=\"line\">- 准备建议和购物清单</span><br><span class=\"line\">【输出格式】: 按日分段，每餐列出具体食物</span><br><span class=\"line\">【语言风格】: 专业但友好</span><br><span class=\"line\">【限制条件】: 考虑准备时间短，预算有限</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4、错误分析与修正\"><a href=\"#4、错误分析与修正\" class=\"headerlink\" title=\"4、错误分析与修正\"></a>4、错误分析与修正</h4><p>系统性分析⁠模型回答中的错误，并‌针对性优化提示词，这一点在我们使用 Cu‎rsor 等 AI ‌开发工具生成代码时非常有用。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">我发现之前请你生成的Python代码存在以下问题:</span><br><span class=\"line\">1. 没有正确处理文件不存在的情况</span><br><span class=\"line\">2. 数据处理逻辑中存在边界条件错误</span><br><span class=\"line\">3. 代码注释不够详细</span><br><span class=\"line\"></span><br><span class=\"line\">请重新生成代码，特别注意:</span><br><span class=\"line\">1. 添加完整的异常处理</span><br><span class=\"line\">2. 测试并确保所有边界条件</span><br><span class=\"line\">3. 为每个主要函数和复杂逻辑添加详细注释</span><br><span class=\"line\">4. 遵循PEP 8编码规范</span><br></pre></td></tr></table></figure>\n\n<p>虽然前面提到了这么多提示词优化技巧，但总结出来就一句话：<strong>任务越复杂，就越要给 Prompt 补充更多细节。</strong></p>\n<h3 id=\"MVP-最小可行产品策略\"><a href=\"#MVP-最小可行产品策略\" class=\"headerlink\" title=\"MVP 最小可行产品策略\"></a>MVP 最小可行产品策略</h3><p>MVP 最小可行产品策略是指先开发包含 <strong>核心功能</strong> 的基础版本产品快速推向市场，以最小成本验证产品假设和用户需求。通过收集真实用户反馈进行迭代优化，避免开发无人使用的功能，降低资源浪费和开发风险。</p>\n<p>基于这个策略，我们可以先⁠开发一个简单但实用的 AI 对话应用，让用户能‌够和 AI 恋爱大师进行多轮对话交流。因为 “对话” 是本产品的核心功能，暂时不要考虑更复杂的‎功能了。后续可以根据用户用量和反馈，决定下一‌步是深化对话能力还是扩展更多功能模块。</p>\n<p>明确需求后，下面我们进行方案设计，看看怎么实现这个需求。</p>\n<h2 id=\"3、AI-应用方案设计\"><a href=\"#3、AI-应用方案设计\" class=\"headerlink\" title=\"3、AI 应用方案设计\"></a>3、AI 应用方案设计</h2><p>根据需求，⁠我们将实现一个具有‌多轮对话能力的 AI 恋爱大师应用。‎整体方案设计将围绕‌ 2 个核心展开：</p>\n<ul>\n<li>系统提示词的设计</li>\n<li>多轮对话的实现</li>\n</ul>\n<h3 id=\"1、系统提示词设计\"><a href=\"#1、系统提示词设计\" class=\"headerlink\" title=\"1、系统提示词设计\"></a>1、系统提示词设计</h3><p>前面提到，⁠系统提示词相当于 ‌AI 应用的 “灵魂”，直接决定了 ‎AI 的行为模式、‌专业性和交互风格。</p>\n<p>对于 AI⁠ 对话应用，最简单‌的做法是直接写一段系统预设，定义 “‎你是谁？能做什么？‌”，比如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">你是一位恋爱大师，为用户提供情感咨询服务</span><br></pre></td></tr></table></figure>\n\n<p>这种简单提示虽然⁠可以工作，但效果往往不够理想。想‌想现实中的场景，我们去找专家咨询时，专家可能会先主动抛出一系列引‎导性问题、深入了解背景，而不是被‌动等待用户完整描述问题。比如：</p>\n<ul>\n<li>最近有什么迷茫的事情么？</li>\n<li>请问你有什么需要我帮助的事么？</li>\n<li>你们的感情遇到什么问题了么？</li>\n</ul>\n<p>用户会跟 AI⁠ 进行多轮对话，这时 AI‌ 不能像失忆一样，而是要始终保持之前的对话内容作为上‎下文，不断深入了解用户，从‌而提供给用户更全面的建议。</p>\n<p>因此我们要⁠优化系统预设，可以‌借助 AI 进行优化。示例 Prom‎pt：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">我正在开发【恋爱大师】AI 对话应用，请你帮我编写设置给 AI 大模型的系统预设 Prompt 指令。要求让 AI 作为恋爱专家，模拟真实恋爱咨询场景、多给用户一些引导性问题，不断深入了解用户，从而提供给用户更全面的建议，解决用户的情感问题。</span><br></pre></td></tr></table></figure>\n\n<p>AI 提供的优化后系统提示词：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">扮演深耕恋爱心理领域的专家。开场向用户表明身份，告知用户可倾诉恋爱难题。围绕单身、恋爱、已婚三种状态提问：单身状态询问社交圈拓展及追求心仪对象的困扰；恋爱状态询问沟通、习惯差异引发</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、多轮对话实现\"><a href=\"#2、多轮对话实现\" class=\"headerlink\" title=\"2、多轮对话实现\"></a>2、多轮对话实现</h3><p>要实现具有 “记忆力” 的 AI 应用，让 AI 能够记住用户之前的对话内容并保持上下文连贯性，我们可以使用 Spring AI 框架的 <strong>对话记忆能力</strong>。</p>\n<p>如何使用对话记忆能力呢？参考 Spring AI 的官方文档，了解到 Spring AI 提供了 <a href=\"https://docs.spring.io/spring-ai/reference/api/chatclient.html\">ChatClient API</a> 来和 AI 大模型交互。</p>\n<h4 id=\"ChatClient特性\"><a href=\"#ChatClient特性\" class=\"headerlink\" title=\"ChatClient特性\"></a><code>ChatClient</code>特性</h4><p>之前我们是直接使用 Spring Boot 注入的 <a href=\"https://docs.spring.io/spring-ai/reference/api/chatmodel.html\">ChatModel</a> 来调用大模型完成对话，而通过我们自己构造的 ChatClient，可实现功能更丰富、更灵活的 AI 对话客户端，也更推荐通过这种方式调用 AI。</p>\n<p>通过示例代码，⁠能够感受到 ChatMode‌l 和 ChatClient 的区别。ChatClien‎t 支持更复杂灵活的链式调用‌（Fluent API）：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">ChatResponse</span> <span class=\"variable\">response</span> <span class=\"operator\">=</span> chatModel.call(<span class=\"keyword\">new</span> <span class=\"title class_\">Prompt</span>(<span class=\"string\">&quot;你好&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">ChatClient</span> <span class=\"variable\">chatClient</span> <span class=\"operator\">=</span> ChatClient.builder(chatModel)</span><br><span class=\"line\">    .defaultSystem(<span class=\"string\">&quot;你是恋爱顾问&quot;</span>)</span><br><span class=\"line\">    .build();</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">response</span> <span class=\"operator\">=</span> chatClient.prompt().user(<span class=\"string\">&quot;你好&quot;</span>).call().content();</span><br></pre></td></tr></table></figure>\n\n<p>Sprin⁠g AI 提供了多‌种构建 ChatClient 的方式‎，比如自动注入、通‌过建造者模式手动构造：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ChatService</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> ChatClient chatClient;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ChatService</span><span class=\"params\">(ChatClient.Builder builder)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.chatClient = builder</span><br><span class=\"line\">            .defaultSystem(<span class=\"string\">&quot;你是恋爱顾问&quot;</span>)</span><br><span class=\"line\">            .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">ChatClient</span> <span class=\"variable\">chatClient</span> <span class=\"operator\">=</span> ChatClient.builder(chatModel)</span><br><span class=\"line\">    .defaultSystem(<span class=\"string\">&quot;你是恋爱顾问&quot;</span>)</span><br><span class=\"line\">    .build();</span><br></pre></td></tr></table></figure>\n\n<p>ChatC⁠lient 支持多‌种响应格式，比如返回 ChatRes‎ponse 对象、‌返回实体对象、流式返回：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">ChatResponse</span> <span class=\"variable\">chatResponse</span> <span class=\"operator\">=</span> chatClient.prompt()</span><br><span class=\"line\">    .user(<span class=\"string\">&quot;Tell me a joke&quot;</span>)</span><br><span class=\"line\">    .call()</span><br><span class=\"line\">    .chatResponse();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">record</span> <span class=\"title class_\">ActorFilms</span><span class=\"params\">(String actor, List&lt;String&gt; movies)</span> &#123;&#125;</span><br><span class=\"line\"><span class=\"type\">ActorFilms</span> <span class=\"variable\">actorFilms</span> <span class=\"operator\">=</span> chatClient.prompt()</span><br><span class=\"line\">    .user(<span class=\"string\">&quot;Generate the filmography for a random actor.&quot;</span>)</span><br><span class=\"line\">    .call()</span><br><span class=\"line\">    .entity(ActorFilms.class);</span><br><span class=\"line\"></span><br><span class=\"line\">List&lt;ActorFilms&gt; multipleActors = chatClient.prompt()</span><br><span class=\"line\">    .user(<span class=\"string\">&quot;Generate filmography for Tom Hanks and Bill Murray.&quot;</span>)</span><br><span class=\"line\">    .call()</span><br><span class=\"line\">    .entity(<span class=\"keyword\">new</span> <span class=\"title class_\">ParameterizedTypeReference</span>&lt;List&lt;ActorFilms&gt;&gt;() &#123;&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">Flux&lt;String&gt; streamResponse = chatClient.prompt()</span><br><span class=\"line\">    .user(<span class=\"string\">&quot;Tell me a story&quot;</span>)</span><br><span class=\"line\">    .stream()</span><br><span class=\"line\">    .content();</span><br><span class=\"line\"></span><br><span class=\"line\">Flux&lt;ChatResponse&gt; streamWithMetadata = chatClient.prompt()</span><br><span class=\"line\">    .user(<span class=\"string\">&quot;Tell me a story&quot;</span>)</span><br><span class=\"line\">    .stream()</span><br><span class=\"line\">    .chatResponse();</span><br></pre></td></tr></table></figure>\n\n<p>可以给 C⁠hatClient ‌设置默认参数，比如系统提示词，还可以在对‎话时动态更改系统提示‌词的变量，类似模板的概念：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">ChatClient</span> <span class=\"variable\">chatClient</span> <span class=\"operator\">=</span> ChatClient.builder(chatModel)</span><br><span class=\"line\">        .defaultSystem(<span class=\"string\">&quot;You are a friendly chat bot that answers question in the voice of a &#123;voice&#125;&quot;</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">chatClient.prompt()</span><br><span class=\"line\">        .system(sp -&gt; sp.param(<span class=\"string\">&quot;voice&quot;</span>, voice))</span><br><span class=\"line\">        .user(message)</span><br><span class=\"line\">        .call()</span><br><span class=\"line\">        .content());</span><br></pre></td></tr></table></figure>\n\n<p>此外，还支⁠持指定默认对话选项‌、默认拦截器、默认函数调用等等，后面‎教程中都会用到。</p>\n<h4 id=\"Advisors\"><a href=\"#Advisors\" class=\"headerlink\" title=\"Advisors\"></a>Advisors</h4><p>Spring AI 使用 <a href=\"https://docs.spring.io/spring-ai/reference/api/advisors.html\">Advisors</a>（顾问）机制来增强 AI 的能力，可以理解为一系列可插拔的拦截器，在调用 AI 前和调用 AI 后可以执行一些额外的操作，比如：</p>\n<ul>\n<li>前置增强：调用 AI 前改写一下 Prompt 提示词、检查一下提示词是否安全</li>\n<li>后置增强：调用 AI 后记录一下日志、处理一下返回的结果</li>\n</ul>\n<p>为了便于大家理解，后续教程中我可能会经常叫它为拦截器。</p>\n<p>用法很简单，我们可⁠以直接为 <code>ChatClient</code> 指定‌默认拦截器，比如对话记忆拦截器 <em><strong>MessageChatMemoryAdv‎isor</strong></em> 可以帮助我们实现多轮对话能‌力，省去了自己维护对话列表的麻烦。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">var</span> <span class=\"variable\">chatClient</span> <span class=\"operator\">=</span> ChatClient.builder(chatModel)</span><br><span class=\"line\">    .defaultAdvisors(</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">MessageChatMemoryAdvisor</span>(chatMemory), </span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">QuestionAnswerAdvisor</span>(vectorStore)    </span><br><span class=\"line\">    )</span><br><span class=\"line\">    .build();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">response</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.chatClient.prompt()</span><br><span class=\"line\">    </span><br><span class=\"line\">    .advisors(advisor -&gt; advisor.param(<span class=\"string\">&quot;chat_memory_conversation_id&quot;</span>, <span class=\"string\">&quot;678&quot;</span>)</span><br><span class=\"line\">            .param(<span class=\"string\">&quot;chat_memory_response_size&quot;</span>, <span class=\"number\">100</span>))</span><br><span class=\"line\">    .user(userText)</span><br><span class=\"line\">    .call()</span><br><span class=\"line\">\t.content();</span><br></pre></td></tr></table></figure>\n\n<p>Advisors 的原理图如下：</p>\n<p><img src=\"/post/Prompt%E6%8F%90%E7%A4%BA%E8%AF%8D/image-20251105100608398.png\" alt=\"image-20251105100608398\"></p>\n<p>解释上图的执行流程：</p>\n<ol>\n<li>Spring AI 框架从用户的 Prompt 创建一个 AdvisedRequest，同时创建一个空的 AdvisorContext 对象，用于传递信息。</li>\n<li>链中的每个 advisor 处理这个请求，可能会对其进行修改。或者，它也可以选择不调用下一个实体来阻止请求继续传递，这时该 advisor 负责填充响应内容。</li>\n<li>由框架提供的最终 advisor 将请求发送给聊天模型 ChatModel。</li>\n<li>聊天模型的响应随后通过 advisor 链传回，并被转换为 AdvisedResponse。后者包含了共享的 AdvisorContext 实例。</li>\n<li>每个 advisor 都可以处理或修改这个响应。</li>\n<li>最终的 AdvisedResponse 通过提取 ChatCompletion 返回给客户端。</li>\n</ol>\n<p>实际开发中，往往我们会用到多个拦截器，组合在一起相当于一条拦截器链条（责任链模式的设计思想）。每个拦截器是有顺序的，通过 <code>getOrder()</code> 方法获取到顺序，得到的值越低，越优先执行。</p>\n<p>比如下面的代码中，如果单独⁠按照代码顺序，可能我们会认为：将首先执行 Messa‌geChatMemoryAdvisor，将对话历史记录添加到提示词中。然后，QuestionAnswer‎Advisor 将根据用户的问题和添加的对话历史记录‌执行知识库检索，从而提供更相关的结果：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var chatClient = ChatClient.builder(chatModel)</span><br><span class=\"line\">    .defaultAdvisors(</span><br><span class=\"line\">        new MessageChatMemoryAdvisor(chatMemory), </span><br><span class=\"line\">        new QuestionAnswerAdvisor(vectorStore)    </span><br><span class=\"line\">    )</span><br><span class=\"line\">    .build();</span><br></pre></td></tr></table></figure>\n\n<p>但是实际上⁠，我们拦截器的执行‌顺序是由 getOrder 方法决定‎的，不是简单地根据‌代码的编写顺序决定。</p>\n<p>Advisor 类图如下，了解即可：</p>\n<p><img src=\"/post/Prompt%E6%8F%90%E7%A4%BA%E8%AF%8D/image-20251105101503606.png\" alt=\"image-20251105101503606\"></p>\n<p>从上图中我们发现，Advi⁠sors 分为 2 种模式：流式 Streamin‌g 和非流式 Non-Streaming，二者在用法上没有明显的区别，返回值不同罢了。但是如果我们要‎自主实现 Advisors，为了保证通用性，最好还‌是同时实现流式和非流式的环绕通知方法。</p>\n<p><img src=\"/post/Prompt%E6%8F%90%E7%A4%BA%E8%AF%8D/image-20251105102148497.png\" alt=\"image-20251105102148497\"></p>\n<h4 id=\"Chat-Memory-Advisor\"><a href=\"#Chat-Memory-Advisor\" class=\"headerlink\" title=\"Chat Memory Advisor\"></a>Chat Memory Advisor</h4><p>前面我们提到⁠了，想要实现对话记忆功能‌，可以使用 Spring AI 的 ChatMe‎moryAdvisor，‌它主要有几种内置的实现方式：</p>\n<ul>\n<li>MessageChatMemoryAdvisor：从记忆中检索历史对话，并将其作为消息集合添加到提示词中</li>\n<li>PromptChatMemoryAdvisor：从记忆中检索历史对话，并将其添加到提示词的系统文本中</li>\n<li>VectorStoreChatMemoryAdvisor：可以用向量数据库来存储检索历史对话</li>\n</ul>\n<p>Messag⁠eChatMemoryA‌dvisor 和 PromptChatMemor‎yAdvisor 用法类‌似，但是略有一些区别：</p>\n<p>1）Messag⁠eChatMemoryAdvi‌sor 将对话历史作为一系列独立的消息添加到提示中，保留原始‎对话的完整结构，包括每条消息的‌角色标识（用户、助手、系统）。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[</span><br><span class=\"line\">  &#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;你好&quot;&#125;,</span><br><span class=\"line\">  &#123;&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: &quot;你好！有什么我能帮助你的吗？&quot;&#125;,</span><br><span class=\"line\">  &#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;讲个笑话&quot;&#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<p>2）Prom⁠ptChatMemor‌yAdvisor 将对话历史添加到提示词的系‎统文本部分，因此可能会‌失去原始的消息边界。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">以下是之前的对话历史：</span><br><span class=\"line\">用户: 你好</span><br><span class=\"line\">助手: 你好！有什么我能帮助你的吗？</span><br><span class=\"line\">用户: 讲个笑话</span><br><span class=\"line\"></span><br><span class=\"line\">现在请继续回答用户的问题。</span><br></pre></td></tr></table></figure>\n\n<p>** 一般情况下，更建议使用 MessageChatMemoryAdvisor。** 更符合大多数现代 LLM 的对话模型设计，能更好地保持上下文连贯性。</p>\n<h4 id=\"Chat-Memory\"><a href=\"#Chat-Memory\" class=\"headerlink\" title=\"Chat Memory\"></a>Chat Memory</h4><p>上述 ChatMemoryAdvisor 都依赖 <a href=\"https://docs.spring.io/spring-ai/reference/api/chatclient.html#_chat_memory\">Chat Memory</a> 进行构造，Chat Memory 负责历史对话的存储，定义了保存消息、查询消息、清空消息历史的方法。</p>\n<p><img src=\"/post/Prompt%E6%8F%90%E7%A4%BA%E8%AF%8D/image-20251105102638633.png\" alt=\"image-20251105102638633\"></p>\n<p>Sprin⁠g AI 内置了几‌种 Chat Memory，可以将对‎话保存到不同的数据‌源中，比如：</p>\n<ul>\n<li>InMemoryChatMemory：内存存储</li>\n<li>CassandraChatMemory：在 Cassandra 中带有过期时间的持久化存储</li>\n<li>Neo4jChatMemory：在 Neo4j 中没有过期时间限制的持久化存储</li>\n<li>JdbcChatMemory：在 JDBC 中没有过期时间限制的持久化存储</li>\n</ul>\n<p>当然也可以⁠通过实现 Chat‌Memory 接口自定义数据源的存储‎，本教程后续会带‌大家实战。</p>\n<p>了解了 S⁠pring AI ‌多轮对话的实现机制后，下面我们进入 ‎AI 应用的开发。</p>\n<h2 id=\"4、多轮对话-AI-应用开发\"><a href=\"#4、多轮对话-AI-应用开发\" class=\"headerlink\" title=\"4、多轮对话 AI 应用开发\"></a>4、多轮对话 AI 应用开发</h2><p>在后端项目根包下新建 <code>app</code> 包，存放 AI 应用，新建 <code>LoveApp.java</code>。可以参考 Spring AI Alibaba 官方的 <a href=\"https://java2ai.com/docs/1.0.0-M6.1/tutorials/memory/#%E5%9F%BA%E4%BA%8Ememory%E7%9A%84%E5%AF%B9%E8%AF%9D%E8%AE%B0%E5%BF%86\">示例代码</a> 实现（其实用的还是 Spring AI）。</p>\n<p>1）首先初始化 ChatC⁠lient 对象。使用 Spring 的构造器注入方‌式来注入阿里大模型 dashscopeChatModel 对象，并使用该对象来初始化 ChatCli‎ent。初始化时指定默认的系统 Prompt 和基于内存‌的对话记忆 Advisor。代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LoveApp</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> ChatClient chatClient;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">SYSTEM_PROMPT</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;扮演深耕恋爱心理领域的专家。开场向用户表明身份，告知用户可倾诉恋爱难题。&quot;</span> +</span><br><span class=\"line\">            <span class=\"string\">&quot;围绕单身、恋爱、已婚三种状态提问：单身状态询问社交圈拓展及追求心仪对象的困扰；&quot;</span> +</span><br><span class=\"line\">            <span class=\"string\">&quot;恋爱状态询问沟通、习惯差异引发的矛盾；已婚状态询问家庭责任与亲属关系处理的问题。&quot;</span> +</span><br><span class=\"line\">            <span class=\"string\">&quot;引导用户详述事情经过、对方反应及自身想法，以便给出专属解决方案。&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">LoveApp</span><span class=\"params\">(ChatModel dashscopeChatModel)</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"type\">ChatMemory</span> <span class=\"variable\">chatMemory</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InMemoryChatMemory</span>();</span><br><span class=\"line\">        chatClient = ChatClient.builder(dashscopeChatModel)</span><br><span class=\"line\">                .defaultSystem(SYSTEM_PROMPT)</span><br><span class=\"line\">                .defaultAdvisors(</span><br><span class=\"line\">                        <span class=\"keyword\">new</span> <span class=\"title class_\">MessageChatMemoryAdvisor</span>(chatMemory)</span><br><span class=\"line\">                )</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>2）编写对话方法⁠。调用 chatClie‌nt 对象，传入用户 Prompt，并且给 advi‎sor 指定对话 id 和对话‌记忆大小。代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> String <span class=\"title function_\">doChat</span><span class=\"params\">(String message, String chatId)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">ChatResponse</span> <span class=\"variable\">response</span> <span class=\"operator\">=</span> chatClient</span><br><span class=\"line\">            .prompt()</span><br><span class=\"line\">            .user(message)</span><br><span class=\"line\">            .advisors(spec -&gt; spec.param(CHAT_MEMORY_CONVERSATION_ID_KEY, chatId)</span><br><span class=\"line\">                    .param(CHAT_MEMORY_RETRIEVE_SIZE_KEY, <span class=\"number\">10</span>))</span><br><span class=\"line\">            .call()</span><br><span class=\"line\">            .chatResponse();</span><br><span class=\"line\">    <span class=\"type\">String</span> <span class=\"variable\">content</span> <span class=\"operator\">=</span> response.getResult().getOutput().getText();</span><br><span class=\"line\">    log.info(<span class=\"string\">&quot;content: &#123;&#125;&quot;</span>, content);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> content;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3）编写单元测试，测试多轮对话：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">LoveAppTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Resource</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LoveApp loveApp;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">testChat</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">chatId</span> <span class=\"operator\">=</span> UUID.randomUUID().toString();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;你好，我是Azer&quot;</span>;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">answer</span> <span class=\"operator\">=</span> loveApp.doChat(message, chatId);</span><br><span class=\"line\">        Assertions.assertNotNull(answer);</span><br><span class=\"line\">        </span><br><span class=\"line\">        message = <span class=\"string\">&quot;我想让另一半（ZA）更爱我&quot;</span>;</span><br><span class=\"line\">        answer = loveApp.doChat(message, chatId);</span><br><span class=\"line\">        Assertions.assertNotNull(answer);</span><br><span class=\"line\">        </span><br><span class=\"line\">        message = <span class=\"string\">&quot;我的另一半叫什么来着？刚跟你说过，帮我回忆一下&quot;</span>;</span><br><span class=\"line\">        answer = loveApp.doChat(message, chatId);</span><br><span class=\"line\">        Assertions.assertNotNull(answer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/Prompt%E6%8F%90%E7%A4%BA%E8%AF%8D/image-20251105141545144.png\" alt=\"image-20251105141545144\"></p>\n<p>成功，并且拥有会话记忆</p>\n","feature":true,"text":"1、Prompt 工程​ 很多人其实根本不了解Prompt ,这里我自己的最简单的理解是：我自己使用ai的时候，我会先给他一个角色，比如你现在只能用Spring...","permalink":"/post/Prompt提示词","photos":[],"count_time":{"symbolsCount":"15k","symbolsTime":"14 mins."},"categories":[{"name":"SpringBoot","slug":"SpringBoot","count":4,"path":"api/categories/SpringBoot.json"},{"name":"Spring AI","slug":"SpringBoot/Spring-AI","count":3,"path":"api/categories/SpringBoot/Spring-AI.json"}],"tags":[{"name":"Spring AI","slug":"Spring-AI","count":4,"path":"api/tags/Spring-AI.json"},{"name":"大模型","slug":"大模型","count":4,"path":"api/tags/大模型.json"},{"name":"AI","slug":"AI","count":3,"path":"api/tags/AI.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#1%E3%80%81Prompt-%E5%B7%A5%E7%A8%8B\"><span class=\"toc-text\">1、Prompt 工程</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1%E3%80%81%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\"><span class=\"toc-text\">1、基本概念</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%88%86%E7%B1%BB\"><span class=\"toc-text\">提示词分类</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%A0%B8%E5%BF%83-%E5%9F%BA%E4%BA%8E%E8%A7%92%E8%89%B2%E7%9A%84%E5%88%86%E7%B1%BB\"><span class=\"toc-text\">核心 - 基于角色的分类</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2%E3%80%81Token\"><span class=\"toc-text\">2、Token</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97-Token%EF%BC%9F\"><span class=\"toc-text\">如何计算 Token？</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Token-%E6%88%90%E6%9C%AC%E8%AE%A1%E7%AE%97\"><span class=\"toc-text\">Token 成本计算</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Token-%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7\"><span class=\"toc-text\">Token 成本优化技巧</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2%E3%80%81Prompt-%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7\"><span class=\"toc-text\">2、Prompt 优化技巧</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%A9%E7%94%A8%E8%B5%84%E6%BA%90\"><span class=\"toc-text\">利用资源</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%E3%80%81Prompt-%E5%AD%A6%E4%B9%A0\"><span class=\"toc-text\">1、Prompt 学习</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%E3%80%81Prompt-%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%BA%93\"><span class=\"toc-text\">2、Prompt 提示词库</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E7%A1%80%E6%8F%90%E7%A4%BA%E6%8A%80%E5%B7%A7\"><span class=\"toc-text\">基础提示技巧</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%E3%80%81%E6%98%8E%E7%A1%AE%E6%8C%87%E5%AE%9A%E4%BB%BB%E5%8A%A1%E5%92%8C%E8%A7%92%E8%89%B2\"><span class=\"toc-text\">1、明确指定任务和角色</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%E3%80%81%E6%8F%90%E4%BE%9B%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E%E5%92%8C%E5%85%B7%E4%BD%93%E7%A4%BA%E4%BE%8B\"><span class=\"toc-text\">2、提供详细说明和具体示例</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%E3%80%81%E4%BD%BF%E7%94%A8%E7%BB%93%E6%9E%84%E5%8C%96%E6%A0%BC%E5%BC%8F%E5%BC%95%E5%AF%BC%E6%80%9D%E7%BB%B4\"><span class=\"toc-text\">3、使用结构化格式引导思维</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%E3%80%81%E6%98%8E%E7%A1%AE%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%E8%A6%81%E6%B1%82\"><span class=\"toc-text\">4、明确输出格式要求</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BF%9B%E9%98%B6%E6%8F%90%E7%A4%BA%E6%8A%80%E5%B7%A7\"><span class=\"toc-text\">进阶提示技巧</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E2%81%A01%E3%80%81%E6%80%9D%E7%BB%B4%E9%93%BE%E6%8F%90%E7%A4%BA%E6%B3%95%EF%BC%88%E2%80%8CChain-of-Thought%EF%BC%89\"><span class=\"toc-text\">⁠1、思维链提示法（‌Chain-of-Thought）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E2%81%A02%E3%80%81%E5%B0%91%E6%A0%B7%E6%9C%AC%E5%AD%A6%E4%B9%A0%EF%BC%88F%E2%80%8Cew-Shot-Learning%EF%BC%89\"><span class=\"toc-text\">⁠2、少样本学习（F‌ew-Shot Learning）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%E3%80%81%E5%88%86%E6%AD%A5%E9%AA%A4%E6%8C%87%E5%AF%BC%EF%BC%88Step-by-Step%EF%BC%89\"><span class=\"toc-text\">3、分步骤指导（Step-by-Step）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%E3%80%81%E8%87%AA%E6%88%91%E8%AF%84%E4%BC%B0%E5%92%8C%E4%BF%AE%E6%AD%A3\"><span class=\"toc-text\">4、自我评估和修正</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5%E3%80%81%E7%9F%A5%E8%AF%86%E6%A3%80%E7%B4%A2%E5%92%8C%E5%BC%95%E7%94%A8\"><span class=\"toc-text\">5、知识检索和引用</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6%E3%80%81%E5%A4%9A%E8%A7%86%E8%A7%92%E5%88%86%E6%9E%90\"><span class=\"toc-text\">6、多视角分析</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7%E3%80%81%E5%A4%9A%E6%A8%A1%E6%80%81%E6%80%9D%E7%BB%B4\"><span class=\"toc-text\">7、多模态思维</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%8F%90%E7%A4%BA%E8%AF%8D%E8%B0%83%E8%AF%95%E4%B8%8E%E4%BC%98%E5%8C%96\"><span class=\"toc-text\">提示词调试与优化</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%E3%80%81%E8%BF%AD%E4%BB%A3%E5%BC%8F%E6%8F%90%E7%A4%BA%E4%BC%98%E5%8C%96\"><span class=\"toc-text\">1、迭代式提示优化</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%E3%80%81%E8%BE%B9%E7%95%8C%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">2、边界测试</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%E3%80%81%E6%8F%90%E7%A4%BA%E8%AF%8D%E6%A8%A1%E6%9D%BF%E5%8C%96\"><span class=\"toc-text\">3、提示词模板化</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%E3%80%81%E9%94%99%E8%AF%AF%E5%88%86%E6%9E%90%E4%B8%8E%E4%BF%AE%E6%AD%A3\"><span class=\"toc-text\">4、错误分析与修正</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#MVP-%E6%9C%80%E5%B0%8F%E5%8F%AF%E8%A1%8C%E4%BA%A7%E5%93%81%E7%AD%96%E7%95%A5\"><span class=\"toc-text\">MVP 最小可行产品策略</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3%E3%80%81AI-%E5%BA%94%E7%94%A8%E6%96%B9%E6%A1%88%E8%AE%BE%E8%AE%A1\"><span class=\"toc-text\">3、AI 应用方案设计</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%E3%80%81%E7%B3%BB%E7%BB%9F%E6%8F%90%E7%A4%BA%E8%AF%8D%E8%AE%BE%E8%AE%A1\"><span class=\"toc-text\">1、系统提示词设计</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2%E3%80%81%E5%A4%9A%E8%BD%AE%E5%AF%B9%E8%AF%9D%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">2、多轮对话实现</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#ChatClient%E7%89%B9%E6%80%A7\"><span class=\"toc-text\">ChatClient特性</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Advisors\"><span class=\"toc-text\">Advisors</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Chat-Memory-Advisor\"><span class=\"toc-text\">Chat Memory Advisor</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Chat-Memory\"><span class=\"toc-text\">Chat Memory</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4%E3%80%81%E5%A4%9A%E8%BD%AE%E5%AF%B9%E8%AF%9D-AI-%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91\"><span class=\"toc-text\">4、多轮对话 AI 应用开发</span></a></li></ol></li></ol>","author":{"name":"Azer","slug":"blog-author","avatar":"/images/avatar.png","link":"/","description":"<span style='font-size:30px;background:linear-gradient(90deg,#00c6ff,#0072ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;'>怀民亦未寝</span><span style='font-size:30px;'>💕</span>","socials":{"github":"https://github.com/azer-2025","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_52541129?type=blog","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/1764589563?spm_id_from=333.1007.0.0"},"gitee":{"icon":"/svg/gitee.svg","link":"https://gitee.com/azzzer"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"Advisor","uid":"0d1cff3c26f39f16f759d073f873bb99","slug":"Advisor","date":"2025-11-05T13:24:48.000Z","updated":"2025-11-05T13:29:03.507Z","comments":true,"path":"api/articles/Advisor.json","keywords":"VUE、Python、JAVA","cover":"/medias/advisor.png","text":"1、Advisor自定义 Advisor学过 Serv⁠let 和 Spring A‌OP 的同学应该对这个功能并不陌生，我们可以通过编写拦截‎器或切面对请求和...","permalink":"/post/Advisor","photos":[],"count_time":{"symbolsCount":"20k","symbolsTime":"18 mins."},"categories":[{"name":"SpringBoot","slug":"SpringBoot","count":4,"path":"api/categories/SpringBoot.json"},{"name":"Spring AI","slug":"SpringBoot/Spring-AI","count":3,"path":"api/categories/SpringBoot/Spring-AI.json"}],"tags":[{"name":"Spring AI","slug":"Spring-AI","count":4,"path":"api/tags/Spring-AI.json"},{"name":"大模型","slug":"大模型","count":4,"path":"api/tags/大模型.json"},{"name":"AI","slug":"AI","count":3,"path":"api/tags/AI.json"}],"author":{"name":"Azer","slug":"blog-author","avatar":"/images/avatar.png","link":"/","description":"<span style='font-size:30px;background:linear-gradient(90deg,#00c6ff,#0072ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;'>怀民亦未寝</span><span style='font-size:30px;'>💕</span>","socials":{"github":"https://github.com/azer-2025","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_52541129?type=blog","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/1764589563?spm_id_from=333.1007.0.0"},"gitee":{"icon":"/svg/gitee.svg","link":"https://gitee.com/azzzer"}}}},"feature":true},"next_post":{"title":"大模型的接入","uid":"74dcc5cfce20b2ecd28309464beb868c","slug":"大模型的接入","date":"2025-11-05T01:14:09.000Z","updated":"2025-11-05T01:19:39.978Z","comments":true,"path":"api/articles/大模型的接入.json","keywords":"VUE、Python、JAVA","cover":"/medias/大模型接入.png","text":"大模型的接入0.引言​ 最近在学习ai大模型相关的概念，在之前说实话我是一直没学过这方面的相关知识，在2022、2023年左右的时候，那时候ai才刚开始流行，在...","permalink":"/post/大模型的接入","photos":[],"count_time":{"symbolsCount":"8.3k","symbolsTime":"8 mins."},"categories":[{"name":"SpringBoot","slug":"SpringBoot","count":4,"path":"api/categories/SpringBoot.json"},{"name":"Spring AI","slug":"SpringBoot/Spring-AI","count":3,"path":"api/categories/SpringBoot/Spring-AI.json"}],"tags":[{"name":"Spring AI","slug":"Spring-AI","count":4,"path":"api/tags/Spring-AI.json"},{"name":"大模型","slug":"大模型","count":4,"path":"api/tags/大模型.json"},{"name":"AI","slug":"AI","count":3,"path":"api/tags/AI.json"}],"author":{"name":"Azer","slug":"blog-author","avatar":"/images/avatar.png","link":"/","description":"<span style='font-size:30px;background:linear-gradient(90deg,#00c6ff,#0072ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;'>怀民亦未寝</span><span style='font-size:30px;'>💕</span>","socials":{"github":"https://github.com/azer-2025","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_52541129?type=blog","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/1764589563?spm_id_from=333.1007.0.0"},"gitee":{"icon":"/svg/gitee.svg","link":"https://gitee.com/azzzer"}}}},"feature":true}}